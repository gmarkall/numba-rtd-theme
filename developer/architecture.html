

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Numba architecture &mdash; Numba 0.53.0dev0+234.g2a34659be documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/rtd-overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/numba-blue-icon-rgb.svg"/>
  
  
  
    <link rel="canonical" href="https://numba.pydata.org/numba-doc/latest/index.htmldeveloper/architecture.html"/>
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Polymorphic dispatching" href="dispatching.html" />
    <link rel="prev" title="A Map of the Numba Repository" href="repomap.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #00A3E0" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Numba
          

          
            
            <img src="../_static/numba-white-icon-rgb.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.53
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">For all users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/5minguide.html">A ~5 minute guide to Numba</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/5minguide.html#how-do-i-get-it">How do I get it?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/5minguide.html#will-numba-work-for-my-code">Will Numba work for my code?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/5minguide.html#what-is-nopython-mode">What is <code class="docutils literal notranslate"><span class="pre">nopython</span></code> mode?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/5minguide.html#how-to-measure-the-performance-of-numba">How to measure the performance of Numba?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/5minguide.html#how-fast-is-it">How fast is it?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/5minguide.html#how-does-numba-work">How does Numba work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/5minguide.html#other-things-of-interest">Other things of interest:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/5minguide.html#gpu-targets">GPU targets:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/installing.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/installing.html#compatibility">Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/installing.html#installing-using-conda-on-x86-x86-64-power-platforms">Installing using conda on x86/x86_64/POWER Platforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/installing.html#installing-using-pip-on-x86-x86-64-platforms">Installing using pip on x86/x86_64 Platforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/installing.html#enabling-amd-rocm-gpu-support">Enabling AMD ROCm GPU Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/installing.html#installing-on-linux-armv7-platforms">Installing on Linux ARMv7 Platforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/installing.html#installing-on-linux-armv8-aarch64-platforms">Installing on Linux ARMv8 (AArch64) Platforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/installing.html#installing-from-source">Installing from source</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/installing.html#build-time-environment-variables-and-configuration-of-optional-components">Build time environment variables and configuration of optional components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/installing.html#dependency-list">Dependency List</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/installing.html#checking-your-installation">Checking your installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/jit.html">Compiling Python code with <code class="docutils literal notranslate"><span class="pre">&#64;jit</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/jit.html#basic-usage">Basic usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/jit.html#lazy-compilation">Lazy compilation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/jit.html#eager-compilation">Eager compilation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/jit.html#calling-and-inlining-other-functions">Calling and inlining other functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/jit.html#signature-specifications">Signature specifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/jit.html#compilation-options">Compilation options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/jit.html#nopython"><code class="docutils literal notranslate"><span class="pre">nopython</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/jit.html#nogil"><code class="docutils literal notranslate"><span class="pre">nogil</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/jit.html#cache"><code class="docutils literal notranslate"><span class="pre">cache</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/jit.html#parallel"><code class="docutils literal notranslate"><span class="pre">parallel</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/generated-jit.html">Flexible specializations with <code class="docutils literal notranslate"><span class="pre">&#64;generated_jit</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/generated-jit.html#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/generated-jit.html#compilation-options">Compilation options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/vectorize.html">Creating NumPy universal functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/vectorize.html#the-vectorize-decorator">The <code class="docutils literal notranslate"><span class="pre">&#64;vectorize</span></code> decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/vectorize.html#the-guvectorize-decorator">The <code class="docutils literal notranslate"><span class="pre">&#64;guvectorize</span></code> decorator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/vectorize.html#overwriting-input-values">Overwriting input values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/vectorize.html#dynamic-universal-functions">Dynamic universal functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/jitclass.html">Compiling Python classes with <code class="docutils literal notranslate"><span class="pre">&#64;jitclass</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/jitclass.html#basic-usage">Basic usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/jitclass.html#inferred-class-member-types-from-type-annotations-with-as-numba-type">Inferred class member types from type annotations with <code class="docutils literal notranslate"><span class="pre">as_numba_type</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/jitclass.html#specifying-numba-typed-containers-as-class-members-explicitly">Specifying <code class="docutils literal notranslate"><span class="pre">numba.typed</span></code> containers as class members explicitly</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/jitclass.html#support-operations">Support operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/jitclass.html#limitations">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/jitclass.html#the-decorator-jitclass">The decorator: <code class="docutils literal notranslate"><span class="pre">&#64;jitclass</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/cfunc.html">Creating C callbacks with <code class="docutils literal notranslate"><span class="pre">&#64;cfunc</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/cfunc.html#basic-usage">Basic usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/cfunc.html#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/cfunc.html#dealing-with-pointers-and-array-memory">Dealing with pointers and array memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/cfunc.html#handling-c-structures">Handling C structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/cfunc.html#with-cffi">With CFFI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/cfunc.html#with-numba-types-record-make-c-struct">With <code class="docutils literal notranslate"><span class="pre">numba.types.Record.make_c_struct</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/cfunc.html#full-example">Full example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/cfunc.html#signature-specification">Signature specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/cfunc.html#compilation-options">Compilation options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/pycc.html">Compiling code ahead of time</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/pycc.html#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/pycc.html#benefits">Benefits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/pycc.html#limitations">Limitations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/pycc.html#usage">Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/pycc.html#standalone-example">Standalone example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/pycc.html#distutils-integration">Distutils integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/pycc.html#signature-syntax">Signature syntax</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/parallel.html">Automatic parallelization with <code class="docutils literal notranslate"><span class="pre">&#64;jit</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/parallel.html#supported-operations">Supported Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/parallel.html#explicit-parallel-loops">Explicit Parallel Loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/parallel.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/parallel.html#diagnostics">Diagnostics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/parallel.html#the-parallel-diagnostics-report-sections">The parallel diagnostics report sections</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/stencil.html">Using the <code class="docutils literal notranslate"><span class="pre">&#64;stencil</span></code> decorator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/stencil.html#basic-usage">Basic usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/stencil.html#stencil-parameters">Stencil Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/stencil.html#kernel-shape-inference-and-border-handling">Kernel shape inference and border handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/stencil.html#stencil-decorator-options">Stencil decorator options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/stencil.html#neighborhood"><code class="docutils literal notranslate"><span class="pre">neighborhood</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/stencil.html#func-or-mode"><code class="docutils literal notranslate"><span class="pre">func_or_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/stencil.html#cval"><code class="docutils literal notranslate"><span class="pre">cval</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/stencil.html#standard-indexing"><code class="docutils literal notranslate"><span class="pre">standard_indexing</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/stencil.html#stencilfunc"><code class="docutils literal notranslate"><span class="pre">StencilFunc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/stencil.html#stencil-invocation-options">Stencil invocation options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/stencil.html#out"><code class="docutils literal notranslate"><span class="pre">out</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/withobjmode.html">Callback into the Python Interpreter from within JIT’ed code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/withobjmode.html#the-objmode-context-manager">The <code class="docutils literal notranslate"><span class="pre">objmode</span></code> context-manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/jit-module.html">Automatic module jitting with <code class="docutils literal notranslate"><span class="pre">jit_module</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/jit-module.html#example-usage">Example usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/jit-module.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/performance-tips.html">Performance Tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/performance-tips.html#no-python-mode-vs-object-mode">No Python mode vs Object mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance-tips.html#loops">Loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance-tips.html#fastmath">Fastmath</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance-tips.html#parallel-true">Parallel=True</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance-tips.html#intel-svml">Intel SVML</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance-tips.html#linear-algebra">Linear algebra</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/threading-layer.html">The Threading Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/threading-layer.html#which-threading-layers-are-available">Which threading layers are available?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/threading-layer.html#setting-the-threading-layer">Setting the threading layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/threading-layer.html#selecting-a-threading-layer-for-safe-parallel-execution">Selecting a threading layer for safe parallel execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/threading-layer.html#selecting-a-named-threading-layer">Selecting a named threading layer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/threading-layer.html#extra-notes">Extra notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/threading-layer.html#setting-the-number-of-threads">Setting the Number of Threads</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/threading-layer.html#example-of-limiting-the-number-of-threads">Example of Limiting the Number of Threads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/threading-layer.html#api-reference">API Reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/cli.html">Command line interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/cli.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/cli.html#help">Help</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/cli.html#system-information">System information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/cli.html#debugging">Debugging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/troubleshoot.html">Troubleshooting and tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/troubleshoot.html#what-to-compile">What to compile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/troubleshoot.html#my-code-doesn-t-compile">My code doesn’t compile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/troubleshoot.html#my-code-has-a-type-unification-problem">My code has a type unification problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/troubleshoot.html#my-code-has-an-untyped-list-problem">My code has an untyped list problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/troubleshoot.html#the-compiled-code-is-too-slow">The compiled code is too slow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/troubleshoot.html#disabling-jit-compilation">Disabling JIT compilation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/troubleshoot.html#debugging-jit-compiled-code-with-gdb">Debugging JIT compiled code with GDB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#example-debug-usage">Example debug usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#globally-override-debug-setting">Globally override debug setting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/troubleshoot.html#using-numba-s-direct-gdb-bindings-in-nopython-mode">Using Numba’s direct <code class="docutils literal notranslate"><span class="pre">gdb</span></code> bindings in <code class="docutils literal notranslate"><span class="pre">nopython</span></code>  mode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#set-up">Set up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#basic-gdb-support">Basic <code class="docutils literal notranslate"><span class="pre">gdb</span></code> support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#running-with-gdb-enabled">Running with <code class="docutils literal notranslate"><span class="pre">gdb</span></code> enabled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#adding-breakpoints-to-code">Adding breakpoints to code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#debugging-in-parallel-regions">Debugging in parallel regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#using-the-gdb-command-language">Using the <code class="docutils literal notranslate"><span class="pre">gdb</span></code> command language</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#how-does-the-gdb-binding-work">How does the <code class="docutils literal notranslate"><span class="pre">gdb</span></code> binding work?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/troubleshoot.html#debugging-cuda-python-code">Debugging CUDA Python code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#using-the-simulator">Using the simulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/troubleshoot.html#debug-info">Debug Info</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/faq.html#programming">Programming</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#can-i-pass-a-function-as-an-argument-to-a-jitted-function">Can I pass a function as an argument to a jitted function?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#numba-doesn-t-seem-to-care-when-i-modify-a-global-variable">Numba doesn’t seem to care when I modify a global variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#can-i-debug-a-jitted-function">Can I debug a jitted function?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#how-can-i-create-a-fortran-ordered-array">How can I create a Fortran-ordered array?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#how-can-i-increase-integer-width">How can I increase integer width?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#how-can-i-tell-if-parallel-true-worked">How can I tell if <code class="docutils literal notranslate"><span class="pre">parallel=True</span></code> worked?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/faq.html#performance">Performance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#does-numba-inline-functions">Does Numba inline functions?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#does-numba-vectorize-array-computations-simd">Does Numba vectorize array computations (SIMD)?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#why-my-loop-is-not-vectorized">Why my loop is not vectorized?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#does-numba-automatically-parallelize-code">Does Numba automatically parallelize code?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#can-numba-speed-up-short-running-functions">Can Numba speed up short-running functions?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#there-is-a-delay-when-jit-compiling-a-complicated-function-how-can-i-improve-it">There is a delay when JIT-compiling a complicated function, how can I improve it?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/faq.html#gpu-programming">GPU Programming</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#how-do-i-work-around-the-cuda-intialized-before-forking-error">How do I work around the <code class="docutils literal notranslate"><span class="pre">CUDA</span> <span class="pre">intialized</span> <span class="pre">before</span> <span class="pre">forking</span></code> error?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/faq.html#integration-with-other-utilities">Integration with other utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#can-i-freeze-an-application-which-uses-numba">Can I “freeze” an application which uses Numba?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#i-get-errors-when-running-a-script-twice-under-spyder">I get errors when running a script twice under Spyder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#why-does-numba-complain-about-the-current-locale">Why does Numba complain about the current locale?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#how-do-i-get-numba-development-builds">How do I get Numba development builds?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/faq.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#where-does-the-project-name-numba-come-from">Where does the project name “Numba” come from?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#how-do-i-reference-cite-acknowledge-numba-in-other-work">How do I reference/cite/acknowledge Numba in other work?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/faq.html#how-do-i-write-a-minimal-working-reproducer-for-a-problem-with-numba">How do I write a minimal working reproducer for a problem with Numba?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/examples.html">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/examples.html#mandelbrot">Mandelbrot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/examples.html#moving-average">Moving average</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/examples.html#multi-threading">Multi-threading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/talks.html">Talks and Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/talks.html#talks-on-numba">Talks on Numba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/talks.html#talks-on-applications-of-numba">Talks on Applications of Numba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/talks.html#tutorials">Tutorials</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/types.html">Types and signatures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#rationale">Rationale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#signatures">Signatures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#basic-types">Basic types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#numbers">Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#arrays">Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#miscellaneous-types">Miscellaneous Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#advanced-types">Advanced types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#inference">Inference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#numpy-scalars">Numpy scalars</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#id1">Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#optional-types">Optional types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#type-annotations">Type annotations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/jit-compilation.html">Just-in-Time compilation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/jit-compilation.html#jit-functions">JIT functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/jit-compilation.html#generated-jit-functions">Generated JIT functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/jit-compilation.html#dispatcher-objects">Dispatcher objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/jit-compilation.html#vectorized-functions-ufuncs-and-dufuncs">Vectorized functions (ufuncs and DUFuncs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/jit-compilation.html#c-callbacks">C callbacks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/aot-compilation.html">Ahead-of-Time compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/utils.html">Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/utils.html#dealing-with-pointers">Dealing with pointers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/envvars.html">Environment variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/envvars.html#jit-flags">Jit flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/envvars.html#debugging">Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/envvars.html#compilation-options">Compilation options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/envvars.html#caching-options">Caching options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/envvars.html#gpu-support">GPU support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/envvars.html#threading-control">Threading Control</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/pysupported.html">Supported Python features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysupported.html#language">Language</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#constructs">Constructs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#generators">Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#exception-handling">Exception handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysupported.html#built-in-types">Built-in types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#int-bool">int, bool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#float-complex">float, complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#str">str</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#tuple">tuple</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#homogeneous-tuples">homogeneous tuples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#heterogeneous-tuples">heterogeneous tuples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#list">list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#set">set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#typed-dict">Typed Dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#heterogeneous-literal-string-key-dictionary">Heterogeneous Literal String Key Dictionary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#none">None</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#bytes-bytearray-memoryview">bytes, bytearray, memoryview</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysupported.html#built-in-functions">Built-in functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#hashing">Hashing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysupported.html#standard-library-modules">Standard library modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#array"><code class="docutils literal notranslate"><span class="pre">array</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#cmath"><code class="docutils literal notranslate"><span class="pre">cmath</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#collections"><code class="docutils literal notranslate"><span class="pre">collections</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#ctypes"><code class="docutils literal notranslate"><span class="pre">ctypes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#enum"><code class="docutils literal notranslate"><span class="pre">enum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#math"><code class="docutils literal notranslate"><span class="pre">math</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#operator"><code class="docutils literal notranslate"><span class="pre">operator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#functools"><code class="docutils literal notranslate"><span class="pre">functools</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#random"><code class="docutils literal notranslate"><span class="pre">random</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#heapq"><code class="docutils literal notranslate"><span class="pre">heapq</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysupported.html#third-party-modules">Third-party modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/pysupported.html#cffi"><code class="docutils literal notranslate"><span class="pre">cffi</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/numpysupported.html">Supported NumPy features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/numpysupported.html#scalar-types">Scalar types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#record-subtyping">Record subtyping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/numpysupported.html#array-types">Array types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#array-access">Array access</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#structured-array-access">Structured array access</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#attributes">Attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#calculation">Calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#other-methods">Other methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/numpysupported.html#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#linear-algebra">Linear algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#reductions">Reductions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#other-functions">Other functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#literal-arrays">Literal arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/numpysupported.html#modules">Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#random"><code class="docutils literal notranslate"><span class="pre">random</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#stride-tricks"><code class="docutils literal notranslate"><span class="pre">stride_tricks</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/numpysupported.html#standard-ufuncs">Standard ufuncs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#limitations">Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#math-operations">Math operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#trigonometric-functions">Trigonometric functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#bit-twiddling-functions">Bit-twiddling functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#comparison-functions">Comparison functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#floating-functions">Floating functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/numpysupported.html#datetime-functions">Datetime functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/pysemantics.html">Deviations from Python Semantics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysemantics.html#bounds-checking">Bounds Checking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysemantics.html#exceptions-and-memory-allocation">Exceptions and Memory Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysemantics.html#integer-width">Integer width</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysemantics.html#boolean-inversion">Boolean inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/pysemantics.html#global-and-closure-variables">Global and closure variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/fpsemantics.html">Floating-point pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/fpsemantics.html#precision-and-accuracy">Precision and accuracy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/fpsemantics.html#math-library-implementations">Math library implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/fpsemantics.html#linear-algebra">Linear algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/fpsemantics.html#mixed-types-operations">Mixed-types operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/fpsemantics.html#warnings-and-errors">Warnings and errors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/deprecation.html">Deprecation Notices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/deprecation.html#suppressing-deprecation-warnings">Suppressing Deprecation warnings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/deprecation.html#deprecation-of-reflection-for-list-and-set-types">Deprecation of reflection for List and Set types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#reason-for-deprecation">Reason for deprecation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#example-s-of-the-impact">Example(s) of the impact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#schedule">Schedule</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#recommendations">Recommendations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#expected-replacement">Expected Replacement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit">Deprecation of <span class="xref std std-term">object mode</span> <cite>fall-back</cite> behaviour when using <code class="docutils literal notranslate"><span class="pre">&#64;jit</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#id1">Reason for deprecation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#id2">Example(s) of the impact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#id3">Schedule</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#id4">Recommendations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/deprecation.html#deprecation-of-the-target-kwarg">Deprecation of the target kwarg</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#id5">Recommendations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/deprecation.html#id6">Schedule</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">For CUDA users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cuda/index.html">Numba for CUDA GPUs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cuda/overview.html">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/overview.html#terminology">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/overview.html#programming-model">Programming model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/overview.html#requirements">Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/overview.html#supported-gpus">Supported GPUs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/overview.html#software">Software</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/overview.html#missing-cuda-features">Missing CUDA Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/kernels.html">Writing CUDA Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/kernels.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/kernels.html#kernel-declaration">Kernel declaration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/kernels.html#kernel-invocation">Kernel invocation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/kernels.html#choosing-the-block-size">Choosing the block size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/kernels.html#multi-dimensional-blocks-and-grids">Multi-dimensional blocks and grids</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/kernels.html#thread-positioning">Thread positioning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/kernels.html#absolute-positions">Absolute positions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/kernels.html#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/memory.html">Memory management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/memory.html#data-transfer">Data transfer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/memory.html#device-arrays">Device arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/memory.html#pinned-memory">Pinned memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/memory.html#mapped-memory">Mapped memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/memory.html#managed-memory">Managed memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/memory.html#streams">Streams</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/memory.html#shared-memory-and-thread-synchronization">Shared memory and thread synchronization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/memory.html#local-memory">Local memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/memory.html#constant-memory">Constant memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/memory.html#deallocation-behavior">Deallocation Behavior</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/device-functions.html">Writing Device Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/cudapysupported.html">Supported Python features in CUDA Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cudapysupported.html#language">Language</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cudapysupported.html#execution-model">Execution Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cudapysupported.html#constructs">Constructs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cudapysupported.html#built-in-types">Built-in types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cudapysupported.html#built-in-functions">Built-in functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cudapysupported.html#standard-library-modules">Standard library modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cudapysupported.html#cmath"><code class="docutils literal notranslate"><span class="pre">cmath</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cudapysupported.html#math"><code class="docutils literal notranslate"><span class="pre">math</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cudapysupported.html#operator"><code class="docutils literal notranslate"><span class="pre">operator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cudapysupported.html#numpy-support">Numpy support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/intrinsics.html">Supported Atomic Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/intrinsics.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/cooperative_groups.html">Cooperative Groups</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cooperative_groups.html#supported-features">Supported features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cooperative_groups.html#using-grid-groups">Using Grid Groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cooperative_groups.html#cooperative-launches">Cooperative Launches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cooperative_groups.html#applications-and-example">Applications and Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/random.html">Random Number Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/random.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/device-management.html">Device management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/device-management.html#device-selection">Device Selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/device-management.html#the-device-list">The Device List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/examples.html">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/examples.html#matrix-multiplication">Matrix multiplication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/simulator.html">Debugging CUDA Python with the the CUDA Simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/simulator.html#using-the-simulator">Using the simulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/simulator.html#supported-features">Supported features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/reduction.html">GPU Reduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/reduction.html#the-reduce-class">The Reduce class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/ufunc.html">CUDA Ufuncs and Generalized Ufuncs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/ufunc.html#example-basic-example">Example: Basic Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/ufunc.html#example-calling-device-functions">Example: Calling Device Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/ufunc.html#generalized-cuda-ufuncs">Generalized CUDA ufuncs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/ipc.html">Sharing CUDA Memory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/ipc.html#sharing-between-process">Sharing between process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/ipc.html#export-device-array-to-another-process">Export device array to another process</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/ipc.html#import-ipc-memory-from-another-process">Import IPC memory from another process</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/cuda_array_interface.html">CUDA Array Interface (Version 3)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/cuda_array_interface.html#python-interface-specification">Python Interface Specification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cuda_array_interface.html#synchronization">Synchronization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cuda_array_interface.html#lifetime-management">Lifetime management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cuda_array_interface.html#lifetime-management-in-numba">Lifetime management in Numba</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cuda_array_interface.html#pointer-attributes">Pointer Attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cuda_array_interface.html#differences-with-cuda-array-interface-version-0">Differences with CUDA Array Interface (Version 0)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cuda_array_interface.html#differences-with-cuda-array-interface-version-1">Differences with CUDA Array Interface (Version 1)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cuda_array_interface.html#differences-with-cuda-array-interface-version-2">Differences with CUDA Array Interface (Version 2)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/cuda_array_interface.html#interoperability">Interoperability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/external-memory.html">External Memory Management (EMM) Plugin interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/external-memory.html#overview-of-external-memory-management">Overview of External Memory Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#effects-on-deallocation-strategies">Effects on Deallocation Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#management-of-other-objects">Management of other objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#asynchronous-allocation-and-deallocation">Asynchronous allocation and deallocation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/external-memory.html#implementing-an-emm-plugin">Implementing an EMM Plugin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#the-host-only-cuda-memory-manager">The Host-Only CUDA Memory Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#the-ipc-handle-mixin">The IPC Handle Mixin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/external-memory.html#classes-and-structures-of-returned-objects">Classes and structures of returned objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#memory-pointers">Memory Pointers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#memory-info">Memory Info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#ipc">IPC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda/external-memory.html#setting-the-emm-plugin">Setting the EMM Plugin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#environment-variable">Environment variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda/external-memory.html#function">Function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda/faq.html">CUDA Frequently Asked Questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda/faq.html#nvprof-reports-no-kernels-were-profiled">nvprof reports “No kernels were profiled”</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cuda-reference/index.html">CUDA Python Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cuda-reference/host.html">CUDA Host API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/host.html#device-management">Device Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/host.html#device-detection-and-enquiry">Device detection and enquiry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/host.html#context-management">Context management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/host.html#id1">Device management</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/host.html#compilation">Compilation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/host.html#measurement">Measurement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/host.html#profiling">Profiling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/host.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/host.html#stream-management">Stream Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/host.html#runtime">Runtime</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda-reference/kernel.html">CUDA Kernel API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/kernel.html#kernel-declaration">Kernel declaration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/kernel.html#dispatcher-objects">Dispatcher objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/kernel.html#intrinsic-attributes-and-functions">Intrinsic Attributes and Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/kernel.html#thread-indexing">Thread Indexing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/kernel.html#memory-management">Memory Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/kernel.html#synchronization-and-atomic-operations">Synchronization and Atomic Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/kernel.html#cooperative-groups">Cooperative Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/kernel.html#memory-fences">Memory Fences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/kernel.html#warp-intrinsics">Warp Intrinsics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/kernel.html#integer-intrinsics">Integer Intrinsics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/kernel.html#floating-point-intrinsics">Floating Point Intrinsics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cuda-reference/kernel.html#control-flow-instructions">Control Flow Instructions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda-reference/memory.html">Memory Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/memory.html#device-objects">Device Objects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cuda-reference/libdevice.html">Libdevice functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cuda-reference/libdevice.html#module-numba.cuda.libdevice">Wrapped functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">For ROCm users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roc/index.html">Numba for AMD ROC GPUs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../roc/overview.html">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../roc/overview.html#terminology">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../roc/overview.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../roc/overview.html#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../roc/kernels.html">Writing HSA Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../roc/kernels.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../roc/kernels.html#introduction-for-cuda-programmers">Introduction for CUDA Programmers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../roc/kernels.html#kernel-declaration">Kernel declaration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../roc/kernels.html#kernel-invocation">Kernel invocation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../roc/kernels.html#choosing-the-workgroup-size">Choosing the workgroup size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../roc/kernels.html#multi-dimensional-workgroup-and-grid">Multi-dimensional workgroup and grid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../roc/kernels.html#workitem-positioning">WorkItem positioning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../roc/memory.html">Memory management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../roc/memory.html#data-transfer">Data transfer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../roc/memory.html#device-arrays">Device arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../roc/memory.html#data-registration">Data Registration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../roc/memory.html#streams">Streams</a></li>
<li class="toctree-l3"><a class="reference internal" href="../roc/memory.html#shared-memory-and-thread-synchronization">Shared memory and thread synchronization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../roc/device-functions.html">Writing Device Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../roc/intrinsics.html">Supported Atomic Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../roc/intrinsics.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../roc/device-management.html">The Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../roc/ufunc.html">ROC Ufuncs and Generalized Ufuncs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../roc/ufunc.html#basic-roc-ufunc-example">Basic ROC UFunc Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../roc/ufunc.html#calling-device-functions-from-roc-ufuncs">Calling Device Functions from ROC UFuncs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../roc/ufunc.html#generalized-roc-ufuncs">Generalized ROC ufuncs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../roc/ufunc.html#async-execution-a-chunk-at-a-time">Async execution: A Chunk at a Time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../roc/examples.html">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../roc/examples.html#matrix-multiplication">Matrix multiplication</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">For advanced users &amp; developers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">Extending Numba</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extending/high-level.html">High-level extension API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extending/high-level.html#implementing-functions">Implementing functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending/high-level.html#implementing-methods">Implementing methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending/high-level.html#implementing-attributes">Implementing attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending/high-level.html#importing-cython-functions">Importing Cython Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending/high-level.html#implementing-intrinsics">Implementing intrinsics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending/high-level.html#implementing-mutable-structures">Implementing mutable structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extending/high-level.html#defining-a-structref">Defining a StructRef</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/high-level.html#defining-a-method-on-structref">Defining a method on StructRef</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/high-level.html#module-numba.experimental.structref"><code class="docutils literal notranslate"><span class="pre">numba.experimental.structref</span></code> API Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extending/high-level.html#determining-if-a-function-is-already-wrapped-by-a-jit-family-decorator">Determining if a function is already wrapped by a <code class="docutils literal notranslate"><span class="pre">jit</span></code> family decorator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extending/low-level.html">Low-level extension API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extending/low-level.html#typing">Typing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending/low-level.html#lowering">Lowering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extending/low-level.html#native-operations">Native operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/low-level.html#constants">Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/low-level.html#boxing-and-unboxing">Boxing and unboxing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extending/interval-example.html">Example: an interval type</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extending/interval-example.html#extending-the-typing-layer">Extending the typing layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extending/interval-example.html#creating-a-new-numba-type">Creating a new Numba type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/interval-example.html#type-inference-for-python-values">Type inference for Python values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/interval-example.html#type-inference-for-python-annotations">Type inference for Python annotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/interval-example.html#type-inference-for-operations">Type inference for operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extending/interval-example.html#extending-the-lowering-layer">Extending the lowering layer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extending/interval-example.html#defining-the-data-model-for-native-intervals">Defining the data model for native intervals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/interval-example.html#exposing-data-model-attributes">Exposing data model attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/interval-example.html#exposing-a-property">Exposing a property</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/interval-example.html#implementing-the-constructor">Implementing the constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extending/interval-example.html#boxing-and-unboxing">Boxing and unboxing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extending/interval-example.html#using-it">Using it</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending/interval-example.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extending/overloading-guide.html">A guide to using <code class="docutils literal notranslate"><span class="pre">&#64;overload</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extending/overloading-guide.html#concrete-example">Concrete Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending/overloading-guide.html#implementing-overload-for-numpy-functions">Implementing <code class="docutils literal notranslate"><span class="pre">&#64;overload</span></code> for NumPy functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extending/entrypoints.html">Registering Extensions with Entry Points</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extending/entrypoints.html#adding-support-for-the-init-entry-point">Adding Support for the “Init” Entry Point</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending/entrypoints.html#testing-your-entry-point">Testing your Entry Point</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing to Numba</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#communication">Communication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#real-time-chat">Real-time Chat</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#mailing-list">Mailing-list</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#weekly-meetings">Weekly Meetings</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#bug-tracker">Bug tracker</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#getting-set-up">Getting set up</a><ul>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#build-environment">Build environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#building-numba">Building Numba</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#running-tests">Running tests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#development-rules">Development rules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#code-reviews">Code reviews</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#coding-conventions">Coding conventions</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#stability">Stability</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#platform-support">Platform support</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#continuous-integration-testing">Continuous integration testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#things-that-help-with-pull-requests">Things that help with pull requests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#documentation">Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#main-documentation">Main documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="contributing.html#web-site-homepage">Web site homepage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="repomap.html">A Map of the Numba Repository</a><ul>
<li class="toctree-l3"><a class="reference internal" href="repomap.html#support-files">Support Files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#build-and-packaging">Build and Packaging</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#continuous-integration">Continuous Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="repomap.html#numba-source-code">Numba Source Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#public-api">Public API</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#dispatching">Dispatching</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#compiler-pipeline">Compiler Pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#type-management">Type Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#compiled-extensions">Compiled Extensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#misc-support">Misc Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#core-python-data-types">Core Python Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#math">Math</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#parallelaccelerator">ParallelAccelerator</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#stencil">Stencil</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#debugging-support">Debugging Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#type-signatures-cpu">Type Signatures (CPU)</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#target-implementations-cpu">Target Implementations (CPU)</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#ufunc-compiler-and-runtime">Ufunc Compiler and Runtime</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#unit-tests-cpu">Unit Tests (CPU)</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#command-line-utilities">Command Line Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#cuda-gpu-target">CUDA GPU Target</a></li>
<li class="toctree-l4"><a class="reference internal" href="repomap.html#rocm-gpu-target">ROCm GPU Target</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Numba architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compiler-architecture">Compiler architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contexts">Contexts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compiler-stages">Compiler stages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#stage-1-analyze-bytecode">Stage 1: Analyze bytecode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stage-2-generate-the-numba-ir">Stage 2: Generate the Numba IR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stage-3-rewrite-untyped-ir">Stage 3: Rewrite untyped IR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stage-4-infer-types">Stage 4: Infer types</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stage-5a-rewrite-typed-ir">Stage 5a: Rewrite typed IR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stage-5b-perform-automatic-parallelization">Stage 5b: Perform Automatic Parallelization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stage-6a-generate-nopython-llvm-ir">Stage 6a: Generate nopython LLVM IR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stage-6b-generate-object-mode-llvm-ir">Stage 6b: Generate object mode LLVM IR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stage-7-compile-llvm-ir-to-machine-code">Stage 7: Compile LLVM IR to machine code</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dispatching.html">Polymorphic dispatching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dispatching.html#requirements">Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dispatching.html#compile-time-vs-run-time">Compile-time vs. run-time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dispatching.html#type-resolution">Type resolution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dispatching.html#typecodes">Typecodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="dispatching.html#hard-coded-fast-paths">Hard-coded fast paths</a></li>
<li class="toctree-l4"><a class="reference internal" href="dispatching.html#fingerprint-based-typecode-cache">Fingerprint-based typecode cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="dispatching.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dispatching.html#specialization-selection">Specialization selection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dispatching.html#implicit-conversion-rules">Implicit conversion rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="dispatching.html#candidates-and-best-match">Candidates and best match</a></li>
<li class="toctree-l4"><a class="reference internal" href="dispatching.html#implementation">Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="dispatching.html#id1">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dispatching.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="generators.html">Notes on generators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generators.html#terminology">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="generators.html#function-analysis">Function analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="generators.html#the-generator-structure">The generator structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generators.html#layout">Layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="generators.html#allocation">Allocation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generators.html#compiling-to-native-code">Compiling to native code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generators.html#the-next-function">The next() function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numba-runtime.html">Notes on Numba Runtime</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numba-runtime.html#memory-management">Memory Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numba-runtime.html#cooperating-with-cpython">Cooperating with CPython</a></li>
<li class="toctree-l4"><a class="reference internal" href="numba-runtime.html#compiler-side-cooperation">Compiler-side Cooperation</a></li>
<li class="toctree-l4"><a class="reference internal" href="numba-runtime.html#optimizations">Optimizations</a></li>
<li class="toctree-l4"><a class="reference internal" href="numba-runtime.html#important-assumptions">Important assumptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="numba-runtime.html#quirks-of-the-old-optimization-pass">Quirks of the old optimization pass</a></li>
<li class="toctree-l4"><a class="reference internal" href="numba-runtime.html#debugging-leaks">Debugging Leaks</a></li>
<li class="toctree-l4"><a class="reference internal" href="numba-runtime.html#debugging-leaks-in-c">Debugging Leaks in C</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="numba-runtime.html#recursion-support">Recursion Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="numba-runtime.html#using-the-nrt-from-c-code">Using the NRT from C code</a></li>
<li class="toctree-l3"><a class="reference internal" href="numba-runtime.html#future-plan">Future Plan</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rewrites.html">Using the Numba Rewrite Pass for Fun and Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rewrites.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="rewrites.html#rewriting-passes">Rewriting Passes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rewrites.html#the-rewrite-base-class">The <code class="xref py py-class docutils literal notranslate"><span class="pre">Rewrite</span></code> Base Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="rewrites.html#subclassing-rewrite">Subclassing <code class="xref py py-class docutils literal notranslate"><span class="pre">Rewrite</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rewrites.html#overloading-rewrite-match">Overloading <code class="xref py py-func docutils literal notranslate"><span class="pre">Rewrite.match()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rewrites.html#overloading-rewrite-apply">Overloading <code class="xref py py-func docutils literal notranslate"><span class="pre">Rewrite.apply()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rewrites.html#the-rewrite-registry">The Rewrite Registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="rewrites.html#case-study-array-expressions">Case study: Array Expressions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rewrites.html#the-rewritearrayexprs-match-method">The <code class="xref py py-func docutils literal notranslate"><span class="pre">RewriteArrayExprs.match()</span></code> method</a></li>
<li class="toctree-l4"><a class="reference internal" href="rewrites.html#the-rewritearrayexprs-apply-method">The <code class="xref py py-func docutils literal notranslate"><span class="pre">RewriteArrayExprs.apply()</span></code> method</a></li>
<li class="toctree-l4"><a class="reference internal" href="rewrites.html#the-lower-array-expr-function">The <code class="xref py py-func docutils literal notranslate"><span class="pre">_lower_array_expr()</span></code> function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rewrites.html#conclusions-and-caveats">Conclusions and Caveats</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="live_variable_analysis.html">Live Variable Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="live_variable_analysis.html#notes-on-behavior-of-the-live-variable-analysis">Notes on behavior of the live variable analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="live_variable_analysis.html#variable-deleted-before-definition">Variable deleted before definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="listings.html">Listings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="listings.html#new-style-listings">New style listings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="autogen_builtins_listing.html">Listings for builtins</a></li>
<li class="toctree-l4"><a class="reference internal" href="autogen_math_listing.html">Listings for math</a></li>
<li class="toctree-l4"><a class="reference internal" href="autogen_cmath_listing.html">Listings for cmath</a></li>
<li class="toctree-l4"><a class="reference internal" href="autogen_numpy_listing.html">Listings for numpy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="listings.html#old-style-listings">Old style listings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="autogen_lower_listing.html">Lowering Listing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stencil.html">Notes on stencils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stencil.html#the-stencil-decorator">The stencil decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="stencil.html#handling-the-three-modes">Handling the three modes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="stencil.html#outside-jit-context">Outside jit context</a></li>
<li class="toctree-l4"><a class="reference internal" href="stencil.html#jit-without-parallel-true">Jit without <code class="docutils literal notranslate"><span class="pre">parallel=True</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stencil.html#jit-with-parallel-true">Jit with <code class="docutils literal notranslate"><span class="pre">parallel=True</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stencil.html#creating-the-stencil-function">Creating the stencil function</a></li>
<li class="toctree-l3"><a class="reference internal" href="stencil.html#exceptions-raised">Exceptions raised</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="custom_pipeline.html">Customizing the Compiler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="custom_pipeline.html#implementing-a-compiler-pass">Implementing a compiler pass</a><ul>
<li class="toctree-l4"><a class="reference internal" href="custom_pipeline.html#compiler-pass-classes">Compiler pass classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="custom_pipeline.html#debugging-compiler-passes">Debugging compiler passes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="custom_pipeline.html#observing-ir-changes">Observing IR Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="custom_pipeline.html#pass-execution-times">Pass execution times</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="inlining.html">Notes on Inlining</a><ul>
<li class="toctree-l3"><a class="reference internal" href="inlining.html#example-using-numba-jit">Example using <code class="xref py py-func docutils literal notranslate"><span class="pre">numba.jit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="inlining.html#example-using-numba-extending-overload">Example using <code class="xref py py-func docutils literal notranslate"><span class="pre">numba.extending.overload()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="inlining.html#using-a-function-to-limit-the-inlining-depth-of-a-recursive-function">Using a function to limit the inlining depth of a recursive function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="environment.html">Environment Object</a><ul>
<li class="toctree-l3"><a class="reference internal" href="environment.html#the-implementation">The Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="environment.html#serialization">Serialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="environment.html#usage">Usage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hashing.html">Notes on Hashing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hashing.html#the-implementation">The Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hashing.html#unicode-hash-cache-differences">Unicode hash cache differences</a></li>
<li class="toctree-l4"><a class="reference internal" href="hashing.html#the-accommodation-of-pythonhashseed">The accommodation of <code class="docutils literal notranslate"><span class="pre">PYTHONHASHSEED</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="caching.html">Notes on Caching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="caching.html#the-implementation">The Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="caching.html#requirements-for-cacheability">Requirements for Cacheability</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#features-compatible-with-caching">Features Compatible with Caching</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#caching-limitations">Caching Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#cache-sharing">Cache Sharing</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#cache-clearing">Cache Clearing</a></li>
<li class="toctree-l4"><a class="reference internal" href="caching.html#related-environment-variables">Related Environment Variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="threading_implementation.html">Notes on Numba’s threading implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="threading_implementation.html#thread-masking">Thread masking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="threading_implementation.html#programming-model">Programming model</a></li>
<li class="toctree-l4"><a class="reference internal" href="threading_implementation.html#the-implementation">The Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="threading_implementation.html#caveats">Caveats</a></li>
<li class="toctree-l4"><a class="reference internal" href="threading_implementation.html#use-in-code-generation">Use in Code Generation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="literal.html">Notes on Literal Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="literal.html#literal-type"><code class="docutils literal notranslate"><span class="pre">Literal</span></code> Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="literal.html#specifying-for-literal-typing">Specifying for Literal Typing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="literal.html#code-example">Code Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="literal.html#internal-details">Internal Details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="literal.html#inside-extensions">Inside Extensions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Notes on Debugging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="debugging.html#memcheck">Memcheck</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html">Numba Project Roadmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="roadmap.html#short-term-2019h1">Short Term: 2019H1</a></li>
<li class="toctree-l3"><a class="reference internal" href="roadmap.html#medium-term-2019h2">Medium Term: 2019H2</a></li>
<li class="toctree-l3"><a class="reference internal" href="roadmap.html#long-term-2020-and-beyond">Long Term: 2020 and beyond</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../proposals/index.html">Numba Enhancement Proposals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../proposals/index.html#implemented-proposals">Implemented proposals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../proposals/integer-typing.html">NBEP 1: Changes in integer typing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../proposals/integer-typing.html#current-semantics">Current semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/integer-typing.html#proposal-predictable-width-conserving-typing">Proposal: predictable width-conserving typing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/integer-typing.html#proposal-impact">Proposal impact</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../proposals/external-memory-management.html">NBEP 7: CUDA External Memory Management Plugins</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../proposals/external-memory-management.html#background-and-goals">Background and goals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/external-memory-management.html#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/external-memory-management.html#interface-for-plugin-developers">Interface for Plugin developers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/external-memory-management.html#example-implementation-a-rapids-memory-manager-rmm-plugin">Example implementation - A RAPIDS Memory Manager (RMM) Plugin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/external-memory-management.html#numba-internal-changes">Numba internal changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/external-memory-management.html#prototyping-experimental-implementation">Prototyping / experimental implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../proposals/index.html#other-proposals">Other proposals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../proposals/extension-points.html">NBEP 2: Extension points</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../proposals/extension-points.html#high-level-api">High-level API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/extension-points.html#typing">Typing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/extension-points.html#code-generation">Code generation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../proposals/jit-classes.html">NBEP 3: JIT Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../proposals/jit-classes.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/jit-classes.html#proposal-jit-classes">Proposal: jit-classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../proposals/cfunc.html">NBEP 4: Defining C callbacks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../proposals/cfunc.html#basic-usage">Basic usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/cfunc.html#passing-array-data">Passing array data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/cfunc.html#error-handling">Error handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/cfunc.html#deferred-topics">Deferred topics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../proposals/type-inference.html">NBEP 5: Type Inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../proposals/type-inference.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/type-inference.html#numba-type-semantic">Numba Type Semantic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/type-inference.html#type-inference">Type Inference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../proposals/typing_recursion.html">NBEP 6: Typing Recursion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../proposals/typing_recursion.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/typing_recursion.html#the-current-state">The Current State</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/typing_recursion.html#the-solution">The Solution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../proposals/typing_recursion.html#limitations">Limitations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-52-0-14-october-2020">Version 0.52.0 (14 October, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-51-2-september-2-2020">Version 0.51.2 (September 2, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-51-1-august-26-2020">Version 0.51.1 (August 26, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-51-0-august-12-2020">Version 0.51.0 (August 12, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-50-1-jun-24-2020">Version 0.50.1 (Jun 24, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-50-0-jun-10-2020">Version 0.50.0 (Jun 10, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-49-1-may-7-2020">Version 0.49.1 (May 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-49-0-apr-16-2020">Version 0.49.0 (Apr 16, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-48-0-jan-27-2020">Version 0.48.0 (Jan 27, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-47-0-jan-2-2020">Version 0.47.0  (Jan 2, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-46-0">Version 0.46.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-45-1">Version 0.45.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-45-0">Version 0.45.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-44-1">Version 0.44.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-44-0">Version 0.44.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-43-1">Version 0.43.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-43-0">Version 0.43.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-42-1">Version 0.42.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-42-0">Version 0.42.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-41-0">Version 0.41.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-40-1">Version 0.40.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-40-0">Version 0.40.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-39-0">Version 0.39.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-38-1">Version 0.38.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-38-0">Version 0.38.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-37-0">Version 0.37.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-36-2">Version 0.36.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-36-1">Version 0.36.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-35-0">Version 0.35.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-34-0">Version 0.34.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-33-0">Version 0.33.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-32-0">Version 0.32.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-31-0">Version 0.31.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-30-1">Version 0.30.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-30-0">Version 0.30.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-29-0">Version 0.29.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-28-1">Version 0.28.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-28-0">Version 0.28.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-27-0">Version 0.27.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-26-0">Version 0.26.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-25-0">Version 0.25.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-24-0">Version 0.24.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-23-1">Version 0.23.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-23-0">Version 0.23.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-22-1">Version 0.22.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-22-0">Version 0.22.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-21-0">Version 0.21.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-20-0">Version 0.20.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-19-2">Version 0.19.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-19-1">Version 0.19.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-19-0">Version 0.19.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-18-2">Version 0.18.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-18-1">Version 0.18.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-17-0">Version 0.17.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-16-0">Version 0.16.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-15-1">Version 0.15.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-15">Version 0.15</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-14">Version 0.14</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-13-4">Version 0.13.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-13-3">Version 0.13.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-13-2">Version 0.13.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-13-1">Version 0.13.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-13">Version 0.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-12-2">Version 0.12.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-12-1">Version 0.12.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-12">Version 0.12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-11">Version 0.11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-10">Version 0.10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-9">Version 0.9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-8">Version 0.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-7-2">Version 0.7.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-7-1">Version 0.7.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-7">Version 0.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-6-1">Version 0.6.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-6">Version 0.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-5">Version 0.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-4">Version 0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-3-2">Version 0.3.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-3">Version 0.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html#version-0-2">Version 0.2</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Numba</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Developer Manual</a> &raquo;</li>
        
      <li>Numba architecture</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/developer/architecture.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="numba-architecture">
<span id="architecture"></span><h1>Numba architecture<a class="headerlink" href="#numba-architecture" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Numba is a compiler for Python bytecode with optional type-specialization.</p>
<p>Suppose you enter a function like this into the standard Python interpreter
(henceforward referred to as “CPython”):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
<p>The interpreter will immediately parse the function and convert it into a
bytecode representation that describes how the CPython interpreter should
execute the function at a low level.  For the example above, it looks
something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
<span class="go">2           0 LOAD_FAST                0 (a)</span>
<span class="go">            3 LOAD_FAST                1 (b)</span>
<span class="go">            6 BINARY_ADD</span>
<span class="go">            7 RETURN_VALUE</span>
</pre></div>
</div>
<p>CPython uses a stack-based interpreter (much like an HP calculator), so the
code first pushes two local variables onto the stack.  The <code class="docutils literal notranslate"><span class="pre">BINARY_ADD</span></code>
opcode pops the top two arguments off the stack and makes a Python C API
function call that is equivalent to calling <code class="docutils literal notranslate"><span class="pre">a.__add__(b)</span></code>.  The result is
then pushed onto the top of the interpreter stack.  Finally, the
<code class="docutils literal notranslate"><span class="pre">RETURN_VALUE</span></code> opcode returns value on the top of the stack as the result of
the function call.</p>
<p>Numba can take this bytecode and compile it to machine code that performs the
same operations as the CPython interpreter, treating <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> as
generic Python objects.  The full semantics of Python are preserved, and the
compiled function can be used with any kind of objects that have the add
operator defined.  When a Numba function is compiled this way, we say that it
has been compiled in <a class="reference internal" href="../glossary.html#term-object-mode"><span class="xref std std-term">object mode</span></a>, because the code still manipulates
Python objects.</p>
<p>Numba code compiled in object mode is not much faster than executing the
original Python function in the CPython interpreter.  However, if we
specialize the function to only run with certain data types, Numba can
generate much shorter and more efficient code that manipulates the data
natively without any calls into the Python C API.  When code has been compiled
for specific data types so that the function body no longer relies on the
Python runtime, we say the function has been compiled in <a class="reference internal" href="../glossary.html#term-nopython-mode"><span class="xref std std-term">nopython mode</span></a>.
Numeric code compiled in nopython mode can be hundreds of times faster
than the original Python.</p>
</div>
<div class="section" id="compiler-architecture">
<h2>Compiler architecture<a class="headerlink" href="#compiler-architecture" title="Permalink to this headline">¶</a></h2>
<p>Like many compilers, Numba can be conceptually divided into a
<em>frontend</em> and a <em>backend</em>.</p>
<p>The Numba <em>frontend</em> comprises the stages which analyze the Python bytecode,
translate it to <a class="reference internal" href="../glossary.html#term-Numba-IR"><span class="xref std std-term">Numba IR</span></a> and perform various transformations and
analysis steps on the IR.  One of the key steps is <a class="reference internal" href="../glossary.html#term-type-inference"><span class="xref std std-term">type inference</span></a>.
The frontend must succeed in typing all variables unambiguously in order
for the backend to generate code in <a class="reference internal" href="../glossary.html#term-nopython-mode"><span class="xref std std-term">nopython mode</span></a>, because the
backend uses type information to match appropriate code generators with
the values they operate on.</p>
<p>The Numba <em>backend</em> walks the Numba IR resulting from the frontend analyses
and exploits the type information deduced by the type inference phase to
produce the right LLVM code for each encountered operation.  After LLVM
code is produced, the LLVM library is asked to optimize it and generate
native processor code for the final, native function.</p>
<p>There are other pieces besides the compiler frontend and backend, such
as the caching machinery for JIT functions.  Those pieces are not considered
in this document.</p>
</div>
<div class="section" id="contexts">
<h2>Contexts<a class="headerlink" href="#contexts" title="Permalink to this headline">¶</a></h2>
<p>Numba is quite flexible, allowing it to generate code for different hardware
architectures like CPUs and GPUs.  In order to support these different
applications, Numba uses a <em>typing context</em> and a <em>target context</em>.</p>
<p>A <em>typing context</em> is used in the compiler frontend to perform type inference
on operations and values in the function.  Similar typing contexts could be
used for many architectures because for nearly all cases, typing inference
is hardware-independent.  However, Numba currently has a different typing
context for each target.</p>
<p>A <em>target context</em> is used to generate the specific instruction sequence
required to operate on the Numba types identified during type inference.
Target contexts are architecture-specific and are flexible in defining
the execution model and available Python APIs.  For example, Numba has a “cpu”
and a “cuda” context for those two kinds of architecture, and a “parallel”
context which produces multithreaded CPU code.</p>
</div>
<div class="section" id="compiler-stages">
<h2>Compiler stages<a class="headerlink" href="#compiler-stages" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../reference/jit-compilation.html#numba.jit" title="numba.jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">jit()</span></code></a> decorator in Numba ultimately calls
<code class="docutils literal notranslate"><span class="pre">numba.compiler.compile_extra()</span></code> which compiles the Python function in a
multi-stage process, described below.</p>
<div class="section" id="stage-1-analyze-bytecode">
<h3>Stage 1: Analyze bytecode<a class="headerlink" href="#stage-1-analyze-bytecode" title="Permalink to this headline">¶</a></h3>
<p>At the start of compilation, the function bytecode is passed to an instance of
the Numba interpreter (<code class="docutils literal notranslate"><span class="pre">numba.interpreter</span></code>).  The interpreter object
analyzes the bytecode to find the control flow graph (<code class="docutils literal notranslate"><span class="pre">numba.controlflow</span></code>).
The control flow graph (CFG) describes the ways that execution can move from one
block to the next inside the function as a result of loops and branches.</p>
<p>The data flow analysis (<code class="docutils literal notranslate"><span class="pre">numba.dataflow</span></code>) takes the control flow graph and
traces how values get pushed and popped off the Python interpreter stack for
different code paths.  This is important to understand the lifetimes of
variables on the stack, which are needed in Stage 2.</p>
<p>If you set the environment variable <code class="docutils literal notranslate"><span class="pre">NUMBA_DUMP_CFG</span></code> to 1, Numba will dump
the results of the control flow graph analysis to the screen.  Our <code class="docutils literal notranslate"><span class="pre">add()</span></code>
example is pretty boring, since there is only one statement block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CFG</span> <span class="n">adjacency</span> <span class="n">lists</span><span class="p">:</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">CFG</span> <span class="n">dominators</span><span class="p">:</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">])}</span>
<span class="n">CFG</span> <span class="n">post</span><span class="o">-</span><span class="n">dominators</span><span class="p">:</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">])}</span>
<span class="n">CFG</span> <span class="n">back</span> <span class="n">edges</span><span class="p">:</span> <span class="p">[]</span>
<span class="n">CFG</span> <span class="n">loops</span><span class="p">:</span>
<span class="p">{}</span>
<span class="n">CFG</span> <span class="n">node</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">loops</span><span class="p">:</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[]}</span>
</pre></div>
</div>
<p>A function with more complex flow control will have a more interesting
control flow graph.  This function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">doloops</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">acc</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">acc</span>
</pre></div>
</div>
<p>compiles to this bytecode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">9</span>           <span class="mi">0</span> <span class="n">LOAD_CONST</span>               <span class="mi">1</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
             <span class="mi">3</span> <span class="n">STORE_FAST</span>               <span class="mi">1</span> <span class="p">(</span><span class="n">acc</span><span class="p">)</span>

<span class="mi">10</span>           <span class="mi">6</span> <span class="n">SETUP_LOOP</span>              <span class="mi">46</span> <span class="p">(</span><span class="n">to</span> <span class="mi">55</span><span class="p">)</span>
             <span class="mi">9</span> <span class="n">LOAD_GLOBAL</span>              <span class="mi">0</span> <span class="p">(</span><span class="nb">range</span><span class="p">)</span>
            <span class="mi">12</span> <span class="n">LOAD_FAST</span>                <span class="mi">0</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="mi">15</span> <span class="n">CALL_FUNCTION</span>            <span class="mi">1</span>
            <span class="mi">18</span> <span class="n">GET_ITER</span>
       <span class="o">&gt;&gt;</span>   <span class="mi">19</span> <span class="n">FOR_ITER</span>                <span class="mi">32</span> <span class="p">(</span><span class="n">to</span> <span class="mi">54</span><span class="p">)</span>
            <span class="mi">22</span> <span class="n">STORE_FAST</span>               <span class="mi">2</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="mi">11</span>          <span class="mi">25</span> <span class="n">LOAD_FAST</span>                <span class="mi">1</span> <span class="p">(</span><span class="n">acc</span><span class="p">)</span>
            <span class="mi">28</span> <span class="n">LOAD_CONST</span>               <span class="mi">2</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="mi">31</span> <span class="n">INPLACE_ADD</span>
            <span class="mi">32</span> <span class="n">STORE_FAST</span>               <span class="mi">1</span> <span class="p">(</span><span class="n">acc</span><span class="p">)</span>

<span class="mi">12</span>          <span class="mi">35</span> <span class="n">LOAD_FAST</span>                <span class="mi">0</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="mi">38</span> <span class="n">LOAD_CONST</span>               <span class="mi">3</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="mi">41</span> <span class="n">COMPARE_OP</span>               <span class="mi">2</span> <span class="p">(</span><span class="o">==</span><span class="p">)</span>
            <span class="mi">44</span> <span class="n">POP_JUMP_IF_FALSE</span>       <span class="mi">19</span>

<span class="mi">13</span>          <span class="mi">47</span> <span class="n">BREAK_LOOP</span>
            <span class="mi">48</span> <span class="n">JUMP_ABSOLUTE</span>           <span class="mi">19</span>
            <span class="mi">51</span> <span class="n">JUMP_ABSOLUTE</span>           <span class="mi">19</span>
       <span class="o">&gt;&gt;</span>   <span class="mi">54</span> <span class="n">POP_BLOCK</span>

<span class="mi">14</span>     <span class="o">&gt;&gt;</span>   <span class="mi">55</span> <span class="n">LOAD_FAST</span>                <span class="mi">1</span> <span class="p">(</span><span class="n">acc</span><span class="p">)</span>
            <span class="mi">58</span> <span class="n">RETURN_VALUE</span>
</pre></div>
</div>
<p>The corresponding CFG for this bytecode is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CFG</span> <span class="n">adjacency</span> <span class="n">lists</span><span class="p">:</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="mi">19</span><span class="p">:</span> <span class="p">[</span><span class="mi">54</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span> <span class="mi">22</span><span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">47</span><span class="p">],</span> <span class="mi">47</span><span class="p">:</span> <span class="p">[</span><span class="mi">55</span><span class="p">],</span> <span class="mi">54</span><span class="p">:</span> <span class="p">[</span><span class="mi">55</span><span class="p">],</span> <span class="mi">55</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">CFG</span> <span class="n">dominators</span><span class="p">:</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
 <span class="mi">6</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span>
 <span class="mi">19</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">]),</span>
 <span class="mi">22</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">22</span><span class="p">]),</span>
 <span class="mi">47</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">47</span><span class="p">]),</span>
 <span class="mi">54</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">54</span><span class="p">]),</span>
 <span class="mi">55</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">55</span><span class="p">])}</span>
<span class="n">CFG</span> <span class="n">post</span><span class="o">-</span><span class="n">dominators</span><span class="p">:</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">55</span><span class="p">]),</span>
 <span class="mi">6</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">55</span><span class="p">]),</span>
 <span class="mi">19</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">19</span><span class="p">,</span> <span class="mi">55</span><span class="p">]),</span>
 <span class="mi">22</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">22</span><span class="p">,</span> <span class="mi">55</span><span class="p">]),</span>
 <span class="mi">47</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">47</span><span class="p">,</span> <span class="mi">55</span><span class="p">]),</span>
 <span class="mi">54</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">]),</span>
 <span class="mi">55</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="mi">55</span><span class="p">])}</span>
<span class="n">CFG</span> <span class="n">back</span> <span class="n">edges</span><span class="p">:</span> <span class="p">[(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">19</span><span class="p">)]</span>
<span class="n">CFG</span> <span class="n">loops</span><span class="p">:</span>
<span class="p">{</span><span class="mi">19</span><span class="p">:</span> <span class="n">Loop</span><span class="p">(</span><span class="n">entries</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="mi">6</span><span class="p">]),</span> <span class="n">exits</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="mi">54</span><span class="p">,</span> <span class="mi">47</span><span class="p">]),</span> <span class="n">header</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="mi">19</span><span class="p">,</span> <span class="mi">22</span><span class="p">]))}</span>
<span class="n">CFG</span> <span class="n">node</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">loops</span><span class="p">:</span>
<span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">19</span><span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="mi">22</span><span class="p">:</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="mi">47</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">54</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">55</span><span class="p">:</span> <span class="p">[]}</span>
</pre></div>
</div>
<p>The numbers in the CFG refer to the bytecode offsets shown just to the left
of the opcode names above.</p>
</div>
<div class="section" id="stage-2-generate-the-numba-ir">
<span id="arch-generate-numba-ir"></span><h3>Stage 2: Generate the Numba IR<a class="headerlink" href="#stage-2-generate-the-numba-ir" title="Permalink to this headline">¶</a></h3>
<p>Once the control flow and data analyses are complete, the Numba interpreter
can step through the bytecode and translate it into an Numba-internal
intermediate representation.  This translation process changes the function
from a stack machine representation (used by the Python interpreter) to a
register machine representation (used by LLVM).</p>
<p>Although the IR is stored in memory as a tree of objects, it can be serialized
to a string for debugging.  If you set the environment variable
<code class="docutils literal notranslate"><span class="pre">NUMBA_DUMP_IR</span></code> equal to 1, the Numba IR will be dumped to the screen.  For
the <code class="docutils literal notranslate"><span class="pre">add()</span></code> function described above, the Numba IR looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>label 0:
    a = arg(0, name=a)                       [&#39;a&#39;]
    b = arg(1, name=b)                       [&#39;b&#39;]
    $0.3 = a + b                             [&#39;$0.3&#39;, &#39;a&#39;, &#39;b&#39;]
    del b                                    []
    del a                                    []
    $0.4 = cast(value=$0.3)                  [&#39;$0.3&#39;, &#39;$0.4&#39;]
    del $0.3                                 []
    return $0.4                              [&#39;$0.4&#39;]
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">del</span></code> instructions are produced by <a class="reference internal" href="live_variable_analysis.html#live-variable-analysis"><span class="std std-ref">Live Variable Analysis</span></a>.
Those instructions ensure references are not leaked.
In <a class="reference internal" href="../glossary.html#term-nopython-mode"><span class="xref std std-term">nopython mode</span></a>, some objects are tracked by the Numba runtime and
some are not.  For tracked objects, a dereference operation is emitted;
otherwise, the instruction is an no-op.
In <a class="reference internal" href="../glossary.html#term-object-mode"><span class="xref std std-term">object mode</span></a> each variable contains an owned reference to a PyObject.</p>
</div>
<div class="section" id="stage-3-rewrite-untyped-ir">
<span id="rewrite-untyped-ir"></span><h3>Stage 3: Rewrite untyped IR<a class="headerlink" href="#stage-3-rewrite-untyped-ir" title="Permalink to this headline">¶</a></h3>
<p>Before running type inference, it may be desired to run certain
transformations on the Numba IR.  One such example is to detect <code class="docutils literal notranslate"><span class="pre">raise</span></code>
statements which have an implicitly constant argument, so as to
support them in <a class="reference internal" href="../glossary.html#term-nopython-mode"><span class="xref std std-term">nopython mode</span></a>.  Let’s say you compile the
following function with Numba:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;x cannot be zero&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you set the <span class="target" id="index-0"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_DUMP_IR"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_DUMP_IR</span></code></a> environment variable to <code class="docutils literal notranslate"><span class="pre">1</span></code>,
you’ll see the IR being rewritten before the type inference phase:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>REWRITING:
    del $0.3                                 []
    $12.1 = global(ValueError: &lt;class &#39;ValueError&#39;&gt;) [&#39;$12.1&#39;]
    $const12.2 = const(str, x cannot be zero) [&#39;$const12.2&#39;]
    $12.3 = call $12.1($const12.2)           [&#39;$12.1&#39;, &#39;$12.3&#39;, &#39;$const12.2&#39;]
    del $const12.2                           []
    del $12.1                                []
    raise $12.3                              [&#39;$12.3&#39;]
____________________________________________________________
    del $0.3                                 []
    $12.1 = global(ValueError: &lt;class &#39;ValueError&#39;&gt;) [&#39;$12.1&#39;]
    $const12.2 = const(str, x cannot be zero) [&#39;$const12.2&#39;]
    $12.3 = call $12.1($const12.2)           [&#39;$12.1&#39;, &#39;$12.3&#39;, &#39;$const12.2&#39;]
    del $const12.2                           []
    del $12.1                                []
    raise &lt;class &#39;ValueError&#39;&gt;(&#39;x cannot be zero&#39;) []
</pre></div>
</div>
</div>
<div class="section" id="stage-4-infer-types">
<span id="arch-type-inference"></span><h3>Stage 4: Infer types<a class="headerlink" href="#stage-4-infer-types" title="Permalink to this headline">¶</a></h3>
<p>Now that the Numba IR has been generated, type analysis can be performed.  The
types of the function arguments can be taken either from the explicit function
signature given in the <code class="docutils literal notranslate"><span class="pre">&#64;jit</span></code> decorator (such as <code class="docutils literal notranslate"><span class="pre">&#64;jit('float64(float64,</span>
<span class="pre">float64)')</span></code>), or they can be taken from the types of the actual function
arguments if compilation is happening when the function is first called.</p>
<p>The type inference engine is found in <code class="docutils literal notranslate"><span class="pre">numba.typeinfer</span></code>.  Its job is to
assign a type to every intermediate variable in the Numba IR.  The result of
this pass can be seen by setting the <span class="target" id="index-1"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_DUMP_ANNOTATION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_DUMP_ANNOTATION</span></code></a>
environment variable to 1:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">-----------------------------------</span><span class="n">ANNOTATION</span><span class="o">-----------------------------------</span>
<span class="c1"># File: archex.py</span>
<span class="c1"># --- LINE 4 ---</span>

<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># --- LINE 5 ---</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>

    <span class="c1"># --- LINE 6 ---</span>
    <span class="c1"># label 0</span>
    <span class="c1">#   a = arg(0, name=a)  :: int64</span>
    <span class="c1">#   b = arg(1, name=b)  :: int64</span>
    <span class="c1">#   $0.3 = a + b  :: int64</span>
    <span class="c1">#   del b</span>
    <span class="c1">#   del a</span>
    <span class="c1">#   $0.4 = cast(value=$0.3)  :: int64</span>
    <span class="c1">#   del $0.3</span>
    <span class="c1">#   return $0.4</span>

    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
<p>If type inference fails to find a consistent type assignment for all the
intermediate variables, it will label every variable as type <code class="docutils literal notranslate"><span class="pre">pyobject</span></code> and
fall back to object mode.  Type inference can fail when unsupported Python
types, language features, or functions are used in the function body.</p>
</div>
<div class="section" id="stage-5a-rewrite-typed-ir">
<span id="rewrite-typed-ir"></span><h3>Stage 5a: Rewrite typed IR<a class="headerlink" href="#stage-5a-rewrite-typed-ir" title="Permalink to this headline">¶</a></h3>
<p>This pass’s purpose is to perform any high-level optimizations that still
require, or could at least benefit from, Numba IR type information.</p>
<p>One example of a problem domain that isn’t as easily optimized once
lowered is the domain of multidimensional array operations.  When
Numba lowers an array operation, Numba treats the operation like a
full ufunc kernel.  During lowering a single array operation, Numba
generates an inline broadcasting loop that creates a new result array.
Then Numba generates an application loop that applies the operator
over the array inputs.  Recognizing and rewriting these loops once
they are lowered into LLVM is hard, if not impossible.</p>
<p>An example pair of optimizations in the domain of array operators is
loop fusion and shortcut deforestation.  When the optimizer
recognizes that the output of one array operator is being fed into
another array operator, and only to that array operator, it can fuse
the two loops into a single loop.  The optimizer can further eliminate
the temporary array allocated for the initial operation by directly
feeding the result of the first operation into the second, skipping
the store and load to the intermediate array.  This elimination is
known as shortcut deforestation.  Numba currently uses the rewrite
pass to implement these array optimizations.  For more information,
please consult the “<a class="reference internal" href="rewrites.html#case-study-array-expressions"><span class="std std-ref">Case study: Array Expressions</span></a>” subsection,
later in this document.</p>
<p>One can see the result of rewriting by setting the
<span class="target" id="index-2"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_DUMP_IR"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_DUMP_IR</span></code></a> environment variable to a non-zero value (such
as 1).  The following example shows the output of the rewrite pass as
it recognizes an array expression consisting of a multiply and add,
and outputs a fused kernel as a special operator, <code class="xref py py-func docutils literal notranslate"><span class="pre">arrayexpr()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>______________________________________________________________________
REWRITING:
a0 = arg(0, name=a0)                     [&#39;a0&#39;]
a1 = arg(1, name=a1)                     [&#39;a1&#39;]
a2 = arg(2, name=a2)                     [&#39;a2&#39;]
$0.3 = a0 * a1                           [&#39;$0.3&#39;, &#39;a0&#39;, &#39;a1&#39;]
del a1                                   []
del a0                                   []
$0.5 = $0.3 + a2                         [&#39;$0.3&#39;, &#39;$0.5&#39;, &#39;a2&#39;]
del a2                                   []
del $0.3                                 []
$0.6 = cast(value=$0.5)                  [&#39;$0.5&#39;, &#39;$0.6&#39;]
del $0.5                                 []
return $0.6                              [&#39;$0.6&#39;]
____________________________________________________________
a0 = arg(0, name=a0)                     [&#39;a0&#39;]
a1 = arg(1, name=a1)                     [&#39;a1&#39;]
a2 = arg(2, name=a2)                     [&#39;a2&#39;]
$0.5 = arrayexpr(ty=array(float64, 1d, C), expr=(&#39;+&#39;, [(&#39;*&#39;, [Var(a0, test.py (14)), Var(a1, test.py (14))]), Var(a2, test.py (14))])) [&#39;$0.5&#39;, &#39;a0&#39;, &#39;a1&#39;, &#39;a2&#39;]
del a0                                   []
del a1                                   []
del a2                                   []
$0.6 = cast(value=$0.5)                  [&#39;$0.5&#39;, &#39;$0.6&#39;]
del $0.5                                 []
return $0.6                              [&#39;$0.6&#39;]
______________________________________________________________________
</pre></div>
</div>
<p>Following this rewrite, Numba lowers the array expression into a new
ufunc-like function that is inlined into a single loop that only
allocates a single result array.</p>
</div>
<div class="section" id="stage-5b-perform-automatic-parallelization">
<span id="parallel-accelerator"></span><h3>Stage 5b: Perform Automatic Parallelization<a class="headerlink" href="#stage-5b-perform-automatic-parallelization" title="Permalink to this headline">¶</a></h3>
<p>This pass is only performed if the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> option in the <a class="reference internal" href="../reference/jit-compilation.html#numba.jit" title="numba.jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">jit()</span></code></a>
decorator is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.  This pass finds parallelism implicit in the
semantics of operations in the Numba IR and replaces those operations
with explicitly parallel representations of those operations using a
special <cite>parfor</cite> operator.  Then, optimizations are performed to maximize
the number of parfors that are adjacent to each other such that they can
then be fused together into one parfor that takes only one pass over the
data and will thus typically have better cache performance.  Finally,
during lowering, these parfor operators are converted to a form similar
to guvectorize to implement the actual parallelism.</p>
<p>The automatic parallelization pass has a number of sub-passes, many of
which are controllable using a dictionary of options passed via the
<code class="docutils literal notranslate"><span class="pre">parallel</span></code> keyword argument to <a class="reference internal" href="../reference/jit-compilation.html#numba.jit" title="numba.jit"><code class="xref py py-func docutils literal notranslate"><span class="pre">jit()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s1">&#39;comprehension&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># parallel comprehension</span>
  <span class="s1">&#39;prange&#39;</span><span class="p">:</span>        <span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># parallel for-loop</span>
  <span class="s1">&#39;numpy&#39;</span><span class="p">:</span>         <span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># parallel numpy calls</span>
  <span class="s1">&#39;reduction&#39;</span><span class="p">:</span>     <span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># parallel reduce calls</span>
  <span class="s1">&#39;setitem&#39;</span><span class="p">:</span>       <span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># parallel setitem</span>
  <span class="s1">&#39;stencil&#39;</span><span class="p">:</span>       <span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># parallel stencils</span>
  <span class="s1">&#39;fusion&#39;</span><span class="p">:</span>        <span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># enable fusion or not</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The default is set to <cite>True</cite> for all of them. The sub-passes are
described in more detail in the following paragraphs.</p>
<ol class="arabic">
<li><dl class="simple">
<dt>CFG Simplification</dt><dd><p>Sometimes Numba IR will contain chains of blocks containing no loops which
are merged in this sub-pass into single blocks.  This sub-pass simplifies
subsequent analysis of the IR.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Numpy canonicalization</dt><dd><p>Some Numpy operations can be written as operations on Numpy objects (e.g.
<code class="docutils literal notranslate"><span class="pre">arr.sum()</span></code>), or as calls to Numpy taking those objects (e.g.
<code class="docutils literal notranslate"><span class="pre">numpy.sum(arr)</span></code>).  This sub-pass converts all such operations to the
latter form for cleaner subsequent analysis.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Array analysis</dt><dd><p>A critical requirement for later parfor fusion is that parfors have
identical iteration spaces and these iteration spaces typically correspond
to the sizes of the dimensions of Numpy arrays.  In this sub-pass, the IR is
analyzed to determine equivalence classes for the dimensions of Numpy
arrays.  Consider the example, <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">b</span> <span class="pre">+</span> <span class="pre">1</span></code>, where <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are both
Numpy arrays.  Here, we know that each dimension of <code class="docutils literal notranslate"><span class="pre">a</span></code> must have the same
equivalence class as the corresponding dimension of <code class="docutils literal notranslate"><span class="pre">b</span></code>.  Typically,
routines rich in Numpy operations will enable equivalence classes to be
fully known for all arrays created within a function.</p>
<p>Array analysis will also reason about size equivalence for slice selection,
and boolean array masking (one dimensional only). For example, it is able to
infer that <code class="docutils literal notranslate"><span class="pre">a[1</span> <span class="pre">:</span> <span class="pre">n-1]</span></code> is of the same size as <code class="docutils literal notranslate"><span class="pre">b[0</span> <span class="pre">:</span> <span class="pre">n-2]</span></code>.</p>
<p>Array analysis may also insert safety assumptions to ensure pre-conditions
related to array sizes are met before an operation can be parallelized.
For example, <code class="docutils literal notranslate"><span class="pre">np.dot(X,</span> <span class="pre">w)</span></code> between a 2-D matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> and a 1-D vector <code class="docutils literal notranslate"><span class="pre">w</span></code>
requires that the second dimension of <code class="docutils literal notranslate"><span class="pre">X</span></code> is of the same size as <code class="docutils literal notranslate"><span class="pre">w</span></code>.
Usually this kind of runtime check is automatically inserted, but if array
analysis can infer such equivalence, it will skip them.</p>
<p>Users can even help array analysis by turning implicit knowledge about
array sizes into explicit assertions. For example, in the code below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logistic_regression</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">iterations</span><span class="p">):</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">w</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">)))</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">Y</span><span class="p">),</span> <span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w</span>
</pre></div>
</div>
<p>Making the explicit assertion helps eliminate all bounds checks in the
rest of the function.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">prange()</span></code> to parfor</dt><dd><p>The use of prange (<a class="reference internal" href="../user/parallel.html#numba-prange"><span class="std std-ref">Explicit Parallel Loops</span></a>) in a for loop is an explicit
indication from the programmer that all iterations of the for loop can
execute in parallel.  In this sub-pass, we analyze the CFG to locate loops
and to convert those loops controlled by a prange object to the explicit
<cite>parfor</cite> operator.  Each explicit parfor operator consists of:</p>
<ol class="loweralpha simple">
<li><p>A list of loop nest information that describes the iteration space of the
parfor.  Each entry in the loop nest list contains an indexing variable,
the start of the range, the end of the range, and the step value for each
iteration.</p></li>
<li><p>An initialization (init) block which contains instructions to be executed
one time before the parfor begins executing.</p></li>
<li><p>A loop body comprising a set of basic blocks that correspond to the body
of the loop and compute one point in the iteration space.</p></li>
<li><p>The index variables used for each dimension of the iteration space.</p></li>
</ol>
<p>For parfor <cite>pranges</cite>, the loop nest is a single entry where the start,
stop, and step fields come from the specified <cite>prange</cite>.  The init block is
empty for <cite>prange</cite> parfors and the loop body is the set of blocks in the
loop minus the loop header.</p>
<p>With parallelization on, array comprehensions (<a class="reference internal" href="../reference/pysupported.html#pysupported-comprehension"><span class="std std-ref">List comprehension</span></a>)
will also be translated to prange so as to run in parallel. This behavior
be disabled by setting <code class="docutils literal notranslate"><span class="pre">parallel={'comprehension':</span> <span class="pre">False}</span></code>.</p>
<p>Likewise, the overall <cite>prange</cite> to <cite>parfor</cite> translation can be disabled by
setting <code class="docutils literal notranslate"><span class="pre">parallel={'prange':</span> <span class="pre">False}</span></code>, in which case <cite>prange</cite> is treated the
same as <cite>range</cite>.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Numpy to parfor</dt><dd><p>In this sub-pass, Numpy functions such as <code class="docutils literal notranslate"><span class="pre">ones</span></code>, <code class="docutils literal notranslate"><span class="pre">zeros</span></code>, <code class="docutils literal notranslate"><span class="pre">dot</span></code>, most
of the random number generating functions, arrayexprs (from Section
<a class="reference internal" href="#rewrite-typed-ir"><span class="std std-ref">Stage 5a: Rewrite typed IR</span></a>), and Numpy reductions are converted to parfors.
Generally, this conversion creates the loop nest list, whose length is equal
to the number of dimensions of the left-hand side of the assignment
instruction in the IR.  The number and size of the dimensions of the
left-hand-side array is taken from the array analysis information generated
in sub-pass 3 above.  An instruction to create the result Numpy array is
generated and stored in the new parfor’s init block.  A basic block is
created for the loop body and an instruction is generated and added to the
end of that block to store the result of the computation into the array at
the current point in the iteration space.  The result stored into the array
depends on the operation that is being converted.  For example, for <code class="docutils literal notranslate"><span class="pre">ones</span></code>,
the value stored is a constant 1.  For calls to generate a random array, the
value comes from a call to the same random number function but with the size
parameter dropped and therefore returning a scalar.  For arrayexpr operators,
the arrayexpr tree is converted to Numba IR and the value at the root of that
expression tree is used to write into the output array. The translation from
Numpy functions and arrayexpr operators to <cite>parfor</cite> can be disabled by
setting <code class="docutils literal notranslate"><span class="pre">parallel={'numpy':</span> <span class="pre">False}</span></code>.</p>
<p>For reductions, the loop nest list is similarly created using the array
analysis information for the array being reduced.  In the init block, the
initial value is assigned to the reduction variable.  The loop body consists
of a single block in which the next value in the iteration space is fetched
and the reduction operation is applied to that value and the current
reduction value and the result stored back into the reduction value.
The translation of reduction functions to <cite>parfor</cite> can be disabled by
setting <code class="docutils literal notranslate"><span class="pre">parallel={'reduction':</span> <span class="pre">False}</span></code>.</p>
<p>Setting the <span class="target" id="index-3"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_DEBUG_ARRAY_OPT_STATS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_DEBUG_ARRAY_OPT_STATS</span></code></a> environment variable to
1 will show some statistics about parfor conversions in general.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Setitem to parfor</dt><dd><p>Setting a range of array elements using a slice or boolean array selection
can also run in parallel.  Statement such as <code class="docutils literal notranslate"><span class="pre">A[P]</span> <span class="pre">=</span> <span class="pre">B[Q]</span></code>
(or a simpler case <code class="docutils literal notranslate"><span class="pre">A[P]</span> <span class="pre">=</span> <span class="pre">c</span></code>, where <code class="docutils literal notranslate"><span class="pre">c</span></code> is a scalar) is translated to
<cite>parfor</cite> if one of the following conditions is met:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> are slices or multi-dimensional selector involving
scalar and slices, and <code class="docutils literal notranslate"><span class="pre">A[P]</span></code> and <code class="docutils literal notranslate"><span class="pre">B[Q]</span></code> are considered size
equivalent by array analysis. Only 2-value slice/range is supported,
3-value with a step will not be translated to <cite>parfor</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> are the same boolean array.</p></li>
</ol>
</div></blockquote>
<p>This translation can be disabled by setting <code class="docutils literal notranslate"><span class="pre">parallel={'setitem':</span> <span class="pre">False}</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Simplification</dt><dd><p>Performs a copy propagation and dead code elimination pass.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Fusion</dt><dd><p>This sub-pass first processes each basic block and does a reordering of the
instructions within the block with the goal of pushing parfors lower in the
block and lifting non-parfors towards the start of the block.  In practice,
this approach does a good job of getting parfors adjacent to each other in
the IR, which enables more parfors to then be fused.  During parfor fusion,
each basic block is repeatedly scanned until no further fusion is possible.
During this scan, each set of adjacent instructions are considered.
Adjacent instructions are fused together if:</p>
<ol class="loweralpha simple">
<li><p>they are both parfors</p></li>
<li><p>the parfors’ loop nests are the same size and the array equivalence
classes for each dimension of the loop nests are the same, and</p></li>
<li><p>the first parfor does not create a reduction variable used by the
second parfor.</p></li>
</ol>
<p>The two parfors are fused together by adding the second parfor’s init block
to the first’s, merging the two parfors’ loop bodies together and replacing
the instances of the second parfor’s loop index variables in the second
parfor’s body with the loop index variables for the first parfor.
Fusion can be disabled by setting <code class="docutils literal notranslate"><span class="pre">parallel={'fusion':</span> <span class="pre">False}</span></code>.</p>
<p>Setting the <span class="target" id="index-4"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_DEBUG_ARRAY_OPT_STATS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_DEBUG_ARRAY_OPT_STATS</span></code></a> environment variable to
1 will show some statistics about parfor fusions.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Push call objects and compute parfor parameters</dt><dd><p>In the lowering phase described in Section <a class="reference internal" href="#lowering"><span class="std std-ref">Stage 6a: Generate nopython LLVM IR</span></a>, each parfor
becomes a separate function executed in parallel in <code class="docutils literal notranslate"><span class="pre">guvectorize</span></code>
(<a class="reference internal" href="../user/vectorize.html#guvectorize"><span class="std std-ref">The &#64;guvectorize decorator</span></a>) style.  Since parfors may use variables defined
previously in a function, when those parfors become separate functions,
those variables must be passed to the parfor function as parameters.  In
this sub-pass, a use-def scan is made over each parfor body and liveness
information is used to determine which variables are used but not defined by
the parfor.  That list of variables is stored here in the parfor for use
during lowering.  Function variables are a special case in this process
since function variables cannot be passed to functions compiled in nopython
mode.  Instead, for function variables, this sub-pass pushes the assignment
instruction to the function variable into the parfor body so that those do
not need to be passed as parameters.</p>
<p>To see the intermediate IR between the above sub-passes and other debugging
information, set the <span class="target" id="index-5"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_DEBUG_ARRAY_OPT"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_DEBUG_ARRAY_OPT</span></code></a> environment variable to
1. For the example in Section <a class="reference internal" href="#rewrite-typed-ir"><span class="std std-ref">Stage 5a: Rewrite typed IR</span></a>, the following IR with
a parfor is generated during this stage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>______________________________________________________________________
label 0:
    a0 = arg(0, name=a0)                     [&#39;a0&#39;]
    a0_sh_attr0.0 = getattr(attr=shape, value=a0) [&#39;a0&#39;, &#39;a0_sh_attr0.0&#39;]
    $consta00.1 = const(int, 0)              [&#39;$consta00.1&#39;]
    a0size0.2 = static_getitem(value=a0_sh_attr0.0, index_var=$consta00.1, index=0) [&#39;$consta00.1&#39;, &#39;a0_sh_attr0.0&#39;, &#39;a0size0.2&#39;]
    a1 = arg(1, name=a1)                     [&#39;a1&#39;]
    a1_sh_attr0.3 = getattr(attr=shape, value=a1) [&#39;a1&#39;, &#39;a1_sh_attr0.3&#39;]
    $consta10.4 = const(int, 0)              [&#39;$consta10.4&#39;]
    a1size0.5 = static_getitem(value=a1_sh_attr0.3, index_var=$consta10.4, index=0) [&#39;$consta10.4&#39;, &#39;a1_sh_attr0.3&#39;, &#39;a1size0.5&#39;]
    a2 = arg(2, name=a2)                     [&#39;a2&#39;]
    a2_sh_attr0.6 = getattr(attr=shape, value=a2) [&#39;a2&#39;, &#39;a2_sh_attr0.6&#39;]
    $consta20.7 = const(int, 0)              [&#39;$consta20.7&#39;]
    a2size0.8 = static_getitem(value=a2_sh_attr0.6, index_var=$consta20.7, index=0) [&#39;$consta20.7&#39;, &#39;a2_sh_attr0.6&#39;, &#39;a2size0.8&#39;]
---begin parfor 0---
index_var =  parfor_index.9
LoopNest(index_variable=parfor_index.9, range=0,a0size0.2,1 correlation=5)
init block:
    $np_g_var.10 = global(np: &lt;module &#39;numpy&#39; from &#39;/usr/local/lib/python3.5/dist-packages/numpy/__init__.py&#39;&gt;) [&#39;$np_g_var.10&#39;]
    $empty_attr_attr.11 = getattr(attr=empty, value=$np_g_var.10) [&#39;$empty_attr_attr.11&#39;, &#39;$np_g_var.10&#39;]
    $np_typ_var.12 = getattr(attr=float64, value=$np_g_var.10) [&#39;$np_g_var.10&#39;, &#39;$np_typ_var.12&#39;]
    $0.5 = call $empty_attr_attr.11(a0size0.2, $np_typ_var.12, kws=(), func=$empty_attr_attr.11, vararg=None, args=[Var(a0size0.2, test2.py (7)), Var($np_typ_var.12, test2.py (7))]) [&#39;$0.5&#39;, &#39;$empty_attr_attr.11&#39;, &#39;$np_typ_var.12&#39;, &#39;a0size0.2&#39;]
label 1:
    $arg_out_var.15 = getitem(value=a0, index=parfor_index.9) [&#39;$arg_out_var.15&#39;, &#39;a0&#39;, &#39;parfor_index.9&#39;]
    $arg_out_var.16 = getitem(value=a1, index=parfor_index.9) [&#39;$arg_out_var.16&#39;, &#39;a1&#39;, &#39;parfor_index.9&#39;]
    $arg_out_var.14 = $arg_out_var.15 * $arg_out_var.16 [&#39;$arg_out_var.14&#39;, &#39;$arg_out_var.15&#39;, &#39;$arg_out_var.16&#39;]
    $arg_out_var.17 = getitem(value=a2, index=parfor_index.9) [&#39;$arg_out_var.17&#39;, &#39;a2&#39;, &#39;parfor_index.9&#39;]
    $expr_out_var.13 = $arg_out_var.14 + $arg_out_var.17 [&#39;$arg_out_var.14&#39;, &#39;$arg_out_var.17&#39;, &#39;$expr_out_var.13&#39;]
    $0.5[parfor_index.9] = $expr_out_var.13  [&#39;$0.5&#39;, &#39;$expr_out_var.13&#39;, &#39;parfor_index.9&#39;]
----end parfor 0----
    $0.6 = cast(value=$0.5)                  [&#39;$0.5&#39;, &#39;$0.6&#39;]
    return $0.6                              [&#39;$0.6&#39;]
______________________________________________________________________
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
<blockquote>
<div></div></blockquote>
</div>
<div class="section" id="stage-6a-generate-nopython-llvm-ir">
<span id="lowering"></span><h3>Stage 6a: Generate nopython LLVM IR<a class="headerlink" href="#stage-6a-generate-nopython-llvm-ir" title="Permalink to this headline">¶</a></h3>
<p>If type inference succeeds in finding a Numba type for every intermediate
variable, then Numba can (potentially) generate specialized native code.  This
process is called <a class="reference internal" href="../glossary.html#term-lowering"><span class="xref std std-term">lowering</span></a>.  The Numba IR tree is translated into
LLVM IR by using helper classes from <a class="reference external" href="http://llvmlite.pydata.org/">llvmlite</a>.
The machine-generated LLVM IR can seem unnecessarily verbose, but the LLVM
toolchain is able to optimize it quite easily into compact, efficient code.</p>
<p>The basic lowering algorithm is generic, but the specifics of how particular
Numba IR nodes are translated to LLVM instructions is handled by the
target context selected for compilation.  The default target context is
the “cpu” context, defined in <code class="docutils literal notranslate"><span class="pre">numba.targets.cpu</span></code>.</p>
<p>The LLVM IR can be displayed by setting the <span class="target" id="index-6"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_DUMP_LLVM"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_DUMP_LLVM</span></code></a> environment
variable to 1.  For the “cpu” context, our <code class="docutils literal notranslate"><span class="pre">add()</span></code> example would look like:</p>
<div class="highlight-llvm notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="k">i32</span> <span class="vg">@&quot;__main__.add$1.int64.int64&quot;</span><span class="p">(</span><span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;retptr&quot;</span><span class="p">,</span>
                                         <span class="p">{</span><span class="k">i8</span><span class="p">*,</span> <span class="k">i32</span><span class="p">}**</span> <span class="nv">%&quot;excinfo&quot;</span><span class="p">,</span>
                                         <span class="k">i8</span><span class="p">*</span> <span class="nv">%&quot;env&quot;</span><span class="p">,</span>
                                         <span class="k">i64</span> <span class="nv">%&quot;arg.a&quot;</span><span class="p">,</span> <span class="k">i64</span> <span class="nv">%&quot;arg.b&quot;</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nl">entry:</span>
     <span class="nv">%&quot;a&quot;</span> <span class="p">=</span> <span class="k">alloca</span> <span class="k">i64</span>
     <span class="nv">%&quot;b&quot;</span> <span class="p">=</span> <span class="k">alloca</span> <span class="k">i64</span>
     <span class="nv">%&quot;$0.3&quot;</span> <span class="p">=</span> <span class="k">alloca</span> <span class="k">i64</span>
     <span class="nv">%&quot;$0.4&quot;</span> <span class="p">=</span> <span class="k">alloca</span> <span class="k">i64</span>
     <span class="k">br</span> <span class="k">label</span> <span class="nv">%&quot;B0&quot;</span>
   <span class="nl">B0:</span>
     <span class="k">store</span> <span class="k">i64</span> <span class="nv">%&quot;arg.a&quot;</span><span class="p">,</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;a&quot;</span>
     <span class="k">store</span> <span class="k">i64</span> <span class="nv">%&quot;arg.b&quot;</span><span class="p">,</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;b&quot;</span>
     <span class="nv">%&quot;.8&quot;</span> <span class="p">=</span> <span class="k">load</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;a&quot;</span>
     <span class="nv">%&quot;.9&quot;</span> <span class="p">=</span> <span class="k">load</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;b&quot;</span>
     <span class="nv">%&quot;.10&quot;</span> <span class="p">=</span> <span class="k">add</span> <span class="k">i64</span> <span class="nv">%&quot;.8&quot;</span><span class="p">,</span> <span class="nv">%&quot;.9&quot;</span>
     <span class="k">store</span> <span class="k">i64</span> <span class="nv">%&quot;.10&quot;</span><span class="p">,</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;$0.3&quot;</span>
     <span class="nv">%&quot;.12&quot;</span> <span class="p">=</span> <span class="k">load</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;$0.3&quot;</span>
     <span class="k">store</span> <span class="k">i64</span> <span class="nv">%&quot;.12&quot;</span><span class="p">,</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;$0.4&quot;</span>
     <span class="nv">%&quot;.14&quot;</span> <span class="p">=</span> <span class="k">load</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;$0.4&quot;</span>
     <span class="k">store</span> <span class="k">i64</span> <span class="nv">%&quot;.14&quot;</span><span class="p">,</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%&quot;retptr&quot;</span>
     <span class="k">ret</span> <span class="k">i32</span> <span class="m">0</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The post-optimization LLVM IR can be output by setting
<span class="target" id="index-7"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_DUMP_OPTIMIZED"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_DUMP_OPTIMIZED</span></code></a> to 1.  The optimizer shortens the code
generated above quite significantly:</p>
<div class="highlight-llvm notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="k">i32</span> <span class="vg">@&quot;__main__.add$1.int64.int64&quot;</span><span class="p">(</span><span class="k">i64</span><span class="p">*</span> <span class="k">nocapture</span> <span class="nv">%retptr</span><span class="p">,</span>
                                         <span class="p">{</span> <span class="k">i8</span><span class="p">*,</span> <span class="k">i32</span> <span class="p">}**</span> <span class="k">nocapture</span> <span class="k">readnone</span> <span class="nv">%excinfo</span><span class="p">,</span>
                                         <span class="k">i8</span><span class="p">*</span> <span class="k">nocapture</span> <span class="k">readnone</span> <span class="nv">%env</span><span class="p">,</span>
                                         <span class="k">i64</span> <span class="nv">%arg.a</span><span class="p">,</span> <span class="k">i64</span> <span class="nv">%arg.b</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nl">entry:</span>
     <span class="nv">%.10</span> <span class="p">=</span> <span class="k">add</span> <span class="k">i64</span> <span class="nv">%arg.b</span><span class="p">,</span> <span class="nv">%arg.a</span>
     <span class="k">store</span> <span class="k">i64</span> <span class="nv">%.10</span><span class="p">,</span> <span class="k">i64</span><span class="p">*</span> <span class="nv">%retptr</span><span class="p">,</span> <span class="k">align</span> <span class="m">8</span>
     <span class="k">ret</span> <span class="k">i32</span> <span class="m">0</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If created during <a class="reference internal" href="#parallel-accelerator"><span class="std std-ref">Stage 5b: Perform Automatic Parallelization</span></a>, parfor operations are
lowered in the following manner.  First, instructions in the parfor’s init
block are lowered into the existing function using the normal lowering code.
Second, the loop body of the parfor is turned into a separate GUFunc.
Third, code is emitted for the current function to call the parallel GUFunc.</p>
<p>To create a GUFunc from the parfor body, the signature of the GUFunc is
created by taking the parfor parameters as identified in step 9 of
Stage <a class="reference internal" href="#parallel-accelerator"><span class="std std-ref">Stage 5b: Perform Automatic Parallelization</span></a> and adding to that a special <cite>schedule</cite>
parameter, across which the GUFunc will be parallelized.  The schedule
parameter is in effect a static schedule mapping portions of the parfor
iteration space to Numba threads and so the length of the schedule
array is the same as the number of configured Numba threads.  To make
this process easier and somewhat less dependent on changes to Numba IR,
this stage creates a Python function as text that contains the parameters
to the GUFunc and iteration code that takes the current schedule entry
and loops through the specified portion of the iteration space.  In the
body of that loop, a special sentinel is inserted for subsequent easy
location.  This code that handles the processing of the iteration space
is then <code class="docutils literal notranslate"><span class="pre">eval</span></code>’ed into existence and the Numba compiler’s run_frontend
function is called to generate IR.  That IR is scanned to locate the
sentinel and the sentinel is replaced with the loop body of the parfor.
Then, the process of creating the parallel GUFunc is completed by
compiling this merged IR with the Numba compiler’s <code class="docutils literal notranslate"><span class="pre">compile_ir</span></code> function.</p>
<p>To call the parallel GUFunc, the static schedule must be created.
Code is inserted to call a function named <code class="docutils literal notranslate"><span class="pre">do_scheduling.</span></code>  This function
is called with the size of each of the parfor’s dimensions and the number
<cite>N</cite> of configured Numba threads (<span class="target" id="index-8"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_NUM_THREADS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_NUM_THREADS</span></code></a>).
The <code class="docutils literal notranslate"><span class="pre">do_scheduling</span></code> function will divide
the iteration space into N approximately equal sized regions (linear for
1D, rectangular for 2D, or hyperrectangles for 3+D) and the resulting
schedule is passed to the parallel GUFunc.  The number of threads
dedicated to a given dimension of the full iteration space is roughly
proportional to the ratio of the size of the given dimension to the sum
of the sizes of all the dimensions of the iteration space.</p>
<p>Parallel reductions are not natively provided by GUFuncs but the parfor
lowering strategy allows us to use GUFuncs in a way that reductions can
be performed in parallel.  To accomplish this, for each reduction variable
computed by a parfor, the parallel GUFunc and the code that calls it are
modified to make the scalar reduction variable into an array of reduction
variables whose length is equal to the number of Numba threads.  In addition,
the GUFunc still contains a scalar version of the reduction variable that
is updated by the parfor body during each iteration.  One time at the
end of the GUFunc this local reduction variable is copied into the
reduction array.  In this way, false sharing of the reduction array is
prevented.  Code is also inserted into the main
function after the parallel GUFunc has returned that does a reduction
across this smaller reduction array and this final reduction value is
then stored into the original scalar reduction variable.</p>
<p>The GUFunc corresponding to the example from Section <a class="reference internal" href="#parallel-accelerator"><span class="std std-ref">Stage 5b: Perform Automatic Parallelization</span></a>
can be seen below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>______________________________________________________________________
label 0:
    sched.29 = arg(0, name=sched)            [&#39;sched.29&#39;]
    a0 = arg(1, name=a0)                     [&#39;a0&#39;]
    a1 = arg(2, name=a1)                     [&#39;a1&#39;]
    a2 = arg(3, name=a2)                     [&#39;a2&#39;]
    _0_5 = arg(4, name=_0_5)                 [&#39;_0_5&#39;]
    $3.1.24 = global(range: &lt;class &#39;range&#39;&gt;) [&#39;$3.1.24&#39;]
    $const3.3.21 = const(int, 0)             [&#39;$const3.3.21&#39;]
    $3.4.23 = getitem(value=sched.29, index=$const3.3.21) [&#39;$3.4.23&#39;, &#39;$const3.3.21&#39;, &#39;sched.29&#39;]
    $const3.6.28 = const(int, 1)             [&#39;$const3.6.28&#39;]
    $3.7.27 = getitem(value=sched.29, index=$const3.6.28) [&#39;$3.7.27&#39;, &#39;$const3.6.28&#39;, &#39;sched.29&#39;]
    $const3.8.32 = const(int, 1)             [&#39;$const3.8.32&#39;]
    $3.9.31 = $3.7.27 + $const3.8.32         [&#39;$3.7.27&#39;, &#39;$3.9.31&#39;, &#39;$const3.8.32&#39;]
    $3.10.36 = call $3.1.24($3.4.23, $3.9.31, kws=[], func=$3.1.24, vararg=None, args=[Var($3.4.23, &lt;string&gt; (2)), Var($3.9.31, &lt;string&gt; (2))]) [&#39;$3.1.24&#39;, &#39;$3.10.36&#39;, &#39;$3.4.23&#39;, &#39;$3.9.31&#39;]
    $3.11.30 = getiter(value=$3.10.36)       [&#39;$3.10.36&#39;, &#39;$3.11.30&#39;]
    jump 1                                   []
label 1:
    $28.2.35 = iternext(value=$3.11.30)      [&#39;$28.2.35&#39;, &#39;$3.11.30&#39;]
    $28.3.25 = pair_first(value=$28.2.35)    [&#39;$28.2.35&#39;, &#39;$28.3.25&#39;]
    $28.4.40 = pair_second(value=$28.2.35)   [&#39;$28.2.35&#39;, &#39;$28.4.40&#39;]
    branch $28.4.40, 2, 3                    [&#39;$28.4.40&#39;]
label 2:
    $arg_out_var.15 = getitem(value=a0, index=$28.3.25) [&#39;$28.3.25&#39;, &#39;$arg_out_var.15&#39;, &#39;a0&#39;]
    $arg_out_var.16 = getitem(value=a1, index=$28.3.25) [&#39;$28.3.25&#39;, &#39;$arg_out_var.16&#39;, &#39;a1&#39;]
    $arg_out_var.14 = $arg_out_var.15 * $arg_out_var.16 [&#39;$arg_out_var.14&#39;, &#39;$arg_out_var.15&#39;, &#39;$arg_out_var.16&#39;]
    $arg_out_var.17 = getitem(value=a2, index=$28.3.25) [&#39;$28.3.25&#39;, &#39;$arg_out_var.17&#39;, &#39;a2&#39;]
    $expr_out_var.13 = $arg_out_var.14 + $arg_out_var.17 [&#39;$arg_out_var.14&#39;, &#39;$arg_out_var.17&#39;, &#39;$expr_out_var.13&#39;]
    _0_5[$28.3.25] = $expr_out_var.13        [&#39;$28.3.25&#39;, &#39;$expr_out_var.13&#39;, &#39;_0_5&#39;]
    jump 1                                   []
label 3:
    $const44.1.33 = const(NoneType, None)    [&#39;$const44.1.33&#39;]
    $44.2.39 = cast(value=$const44.1.33)     [&#39;$44.2.39&#39;, &#39;$const44.1.33&#39;]
    return $44.2.39                          [&#39;$44.2.39&#39;]
______________________________________________________________________
</pre></div>
</div>
</div>
<div class="section" id="stage-6b-generate-object-mode-llvm-ir">
<h3>Stage 6b: Generate object mode LLVM IR<a class="headerlink" href="#stage-6b-generate-object-mode-llvm-ir" title="Permalink to this headline">¶</a></h3>
<p>If type inference fails to find Numba types for all values inside a function,
the function will be compiled in object mode.  The generated LLVM will be
significantly longer, as the compiled code will need to make calls to the
<a class="reference external" href="https://docs.python.org/3/c-api/">Python C API</a> to perform basically all
operations.  The optimized LLVM for our example <code class="docutils literal notranslate"><span class="pre">add()</span></code> function is:</p>
<div class="highlight-llvm notranslate"><div class="highlight"><pre><span></span><span class="vg">@PyExc_SystemError</span> <span class="p">=</span> <span class="k">external</span> <span class="k">global</span> <span class="k">i8</span>
<span class="vg">@&quot;.const.Numba_internal_error:_object_mode_function_called_without_an_environment&quot;</span> <span class="p">=</span> <span class="k">internal</span> <span class="k">constant</span> <span class="p">[</span><span class="m">73</span> <span class="k">x</span> <span class="k">i8</span><span class="p">]</span> <span class="k">c</span><span class="s">&quot;Numba internal error: object mode function called without an environment\00&quot;</span>
<span class="vg">@&quot;.const.name_&#39;a&#39;_is_not_defined&quot;</span> <span class="p">=</span> <span class="k">internal</span> <span class="k">constant</span> <span class="p">[</span><span class="m">24</span> <span class="k">x</span> <span class="k">i8</span><span class="p">]</span> <span class="k">c</span><span class="s">&quot;name &#39;a&#39; is not defined\00&quot;</span>
<span class="vg">@PyExc_NameError</span> <span class="p">=</span> <span class="k">external</span> <span class="k">global</span> <span class="k">i8</span>
<span class="vg">@&quot;.const.name_&#39;b&#39;_is_not_defined&quot;</span> <span class="p">=</span> <span class="k">internal</span> <span class="k">constant</span> <span class="p">[</span><span class="m">24</span> <span class="k">x</span> <span class="k">i8</span><span class="p">]</span> <span class="k">c</span><span class="s">&quot;name &#39;b&#39; is not defined\00&quot;</span>

<span class="k">define</span> <span class="k">i32</span> <span class="vg">@&quot;__main__.add$1.pyobject.pyobject&quot;</span><span class="p">(</span><span class="k">i8</span><span class="p">**</span> <span class="k">nocapture</span> <span class="nv">%retptr</span><span class="p">,</span> <span class="p">{</span> <span class="k">i8</span><span class="p">*,</span> <span class="k">i32</span> <span class="p">}**</span> <span class="k">nocapture</span> <span class="k">readnone</span> <span class="nv">%excinfo</span><span class="p">,</span> <span class="k">i8</span><span class="p">*</span> <span class="k">readnone</span> <span class="nv">%env</span><span class="p">,</span> <span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.a</span><span class="p">,</span> <span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.b</span><span class="p">)</span> <span class="p">{</span>
<span class="nl">entry:</span>
  <span class="nv">%.6</span> <span class="p">=</span> <span class="k">icmp</span> <span class="k">eq</span> <span class="k">i8</span><span class="p">*</span> <span class="nv">%env</span><span class="p">,</span> <span class="k">null</span>
  <span class="k">br</span> <span class="k">i1</span> <span class="nv">%.6</span><span class="p">,</span> <span class="k">label</span> <span class="nv">%entry.if</span><span class="p">,</span> <span class="k">label</span> <span class="nv">%entry.endif</span><span class="p">,</span> <span class="nv">!prof</span> <span class="nv nv-Anonymous">!0</span>

<span class="nl">entry.if:</span>                                         <span class="c">; preds = %entry</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@PyErr_SetString</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="vg">@PyExc_SystemError</span><span class="p">,</span> <span class="k">i8</span><span class="p">*</span> <span class="k">getelementptr</span> <span class="k">inbounds</span> <span class="p">([</span><span class="m">73</span> <span class="k">x</span> <span class="k">i8</span><span class="p">]*</span> <span class="vg">@&quot;.const.Numba_internal_error:_object_mode_function_called_without_an_environment&quot;</span><span class="p">,</span> <span class="k">i64</span> <span class="m">0</span><span class="p">,</span> <span class="k">i64</span> <span class="m">0</span><span class="p">))</span>
  <span class="k">ret</span> <span class="k">i32</span> <span class="m">-1</span>

<span class="nl">entry.endif:</span>                                      <span class="c">; preds = %entry</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_IncRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.a</span><span class="p">)</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_IncRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.b</span><span class="p">)</span>
  <span class="nv">%.21</span> <span class="p">=</span> <span class="k">icmp</span> <span class="k">eq</span> <span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.a</span><span class="p">,</span> <span class="k">null</span>
  <span class="k">br</span> <span class="k">i1</span> <span class="nv">%.21</span><span class="p">,</span> <span class="k">label</span> <span class="nv">%B0.if</span><span class="p">,</span> <span class="k">label</span> <span class="nv">%B0.endif</span><span class="p">,</span> <span class="nv">!prof</span> <span class="nv nv-Anonymous">!0</span>

<span class="nl">B0.if:</span>                                            <span class="c">; preds = %entry.endif</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@PyErr_SetString</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="vg">@PyExc_NameError</span><span class="p">,</span> <span class="k">i8</span><span class="p">*</span> <span class="k">getelementptr</span> <span class="k">inbounds</span> <span class="p">([</span><span class="m">24</span> <span class="k">x</span> <span class="k">i8</span><span class="p">]*</span> <span class="vg">@&quot;.const.name_&#39;a&#39;_is_not_defined&quot;</span><span class="p">,</span> <span class="k">i64</span> <span class="m">0</span><span class="p">,</span> <span class="k">i64</span> <span class="m">0</span><span class="p">))</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="k">null</span><span class="p">)</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.b</span><span class="p">)</span>
  <span class="k">ret</span> <span class="k">i32</span> <span class="m">-1</span>

<span class="nl">B0.endif:</span>                                         <span class="c">; preds = %entry.endif</span>
  <span class="nv">%.30</span> <span class="p">=</span> <span class="k">icmp</span> <span class="k">eq</span> <span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.b</span><span class="p">,</span> <span class="k">null</span>
  <span class="k">br</span> <span class="k">i1</span> <span class="nv">%.30</span><span class="p">,</span> <span class="k">label</span> <span class="nv">%B0.endif1</span><span class="p">,</span> <span class="k">label</span> <span class="nv">%B0.endif1.1</span><span class="p">,</span> <span class="nv">!prof</span> <span class="nv nv-Anonymous">!0</span>

<span class="nl">B0.endif1:</span>                                        <span class="c">; preds = %B0.endif</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@PyErr_SetString</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="vg">@PyExc_NameError</span><span class="p">,</span> <span class="k">i8</span><span class="p">*</span> <span class="k">getelementptr</span> <span class="k">inbounds</span> <span class="p">([</span><span class="m">24</span> <span class="k">x</span> <span class="k">i8</span><span class="p">]*</span> <span class="vg">@&quot;.const.name_&#39;b&#39;_is_not_defined&quot;</span><span class="p">,</span> <span class="k">i64</span> <span class="m">0</span><span class="p">,</span> <span class="k">i64</span> <span class="m">0</span><span class="p">))</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.a</span><span class="p">)</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="k">null</span><span class="p">)</span>
  <span class="k">ret</span> <span class="k">i32</span> <span class="m">-1</span>

<span class="nl">B0.endif1.1:</span>                                      <span class="c">; preds = %B0.endif</span>
  <span class="nv">%.38</span> <span class="p">=</span> <span class="k">tail</span> <span class="k">call</span> <span class="k">i8</span><span class="p">*</span> <span class="vg">@PyNumber_Add</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.a</span><span class="p">,</span> <span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.b</span><span class="p">)</span>
  <span class="nv">%.39</span> <span class="p">=</span> <span class="k">icmp</span> <span class="k">eq</span> <span class="k">i8</span><span class="p">*</span> <span class="nv">%.38</span><span class="p">,</span> <span class="k">null</span>
  <span class="k">br</span> <span class="k">i1</span> <span class="nv">%.39</span><span class="p">,</span> <span class="k">label</span> <span class="nv">%B0.endif1.1.if</span><span class="p">,</span> <span class="k">label</span> <span class="nv">%B0.endif1.1.endif</span><span class="p">,</span> <span class="nv">!prof</span> <span class="nv nv-Anonymous">!0</span>

<span class="nl">B0.endif1.1.if:</span>                                   <span class="c">; preds = %B0.endif1.1</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.a</span><span class="p">)</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.b</span><span class="p">)</span>
  <span class="k">ret</span> <span class="k">i32</span> <span class="m">-1</span>

<span class="nl">B0.endif1.1.endif:</span>                                <span class="c">; preds = %B0.endif1.1</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.b</span><span class="p">)</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%arg.a</span><span class="p">)</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_IncRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%.38</span><span class="p">)</span>
  <span class="k">tail</span> <span class="k">call</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*</span> <span class="nv">%.38</span><span class="p">)</span>
  <span class="k">store</span> <span class="k">i8</span><span class="p">*</span> <span class="nv">%.38</span><span class="p">,</span> <span class="k">i8</span><span class="p">**</span> <span class="nv">%retptr</span><span class="p">,</span> <span class="k">align</span> <span class="m">8</span>
  <span class="k">ret</span> <span class="k">i32</span> <span class="m">0</span>
<span class="p">}</span>

<span class="k">declare</span> <span class="k">void</span> <span class="vg">@PyErr_SetString</span><span class="p">(</span><span class="k">i8</span><span class="p">*,</span> <span class="k">i8</span><span class="p">*)</span>

<span class="k">declare</span> <span class="k">void</span> <span class="vg">@Py_IncRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*)</span>

<span class="k">declare</span> <span class="k">void</span> <span class="vg">@Py_DecRef</span><span class="p">(</span><span class="k">i8</span><span class="p">*)</span>

<span class="k">declare</span> <span class="k">i8</span><span class="p">*</span> <span class="vg">@PyNumber_Add</span><span class="p">(</span><span class="k">i8</span><span class="p">*,</span> <span class="k">i8</span><span class="p">*)</span>
</pre></div>
</div>
<p>The careful reader might notice several unnecessary calls to <code class="docutils literal notranslate"><span class="pre">Py_IncRef</span></code>
and <code class="docutils literal notranslate"><span class="pre">Py_DecRef</span></code> in the generated code.  Currently Numba isn’t able to
optimize those away.</p>
<p>Object mode compilation will also attempt to identify loops which can be
extracted and statically-typed for “nopython” compilation.  This process is
called <em>loop-lifting</em>, and results in the creation of a hidden nopython mode
function just containing the loop which is then called from the original
function.  Loop-lifting helps improve the performance of functions that
need to access uncompilable code (such as I/O or plotting code) but still
contain a time-intensive section of compilable code.</p>
</div>
<div class="section" id="stage-7-compile-llvm-ir-to-machine-code">
<h3>Stage 7: Compile LLVM IR to machine code<a class="headerlink" href="#stage-7-compile-llvm-ir-to-machine-code" title="Permalink to this headline">¶</a></h3>
<p>In both <a class="reference internal" href="../glossary.html#term-object-mode"><span class="xref std std-term">object mode</span></a> and <a class="reference internal" href="../glossary.html#term-nopython-mode"><span class="xref std std-term">nopython mode</span></a>, the generated LLVM IR
is compiled by the LLVM JIT compiler and the machine code is loaded into
memory.  A Python wrapper is also created (defined in
<code class="docutils literal notranslate"><span class="pre">numba.dispatcher.Dispatcher</span></code>) which can do the dynamic dispatch to the
correct version of the compiled function if multiple type specializations
were generated (for example, for both <code class="docutils literal notranslate"><span class="pre">float32</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> versions
of the same function).</p>
<p>The machine assembly code generated by LLVM can be dumped to the screen by
setting the <span class="target" id="index-9"></span><a class="reference internal" href="../reference/envvars.html#envvar-NUMBA_DUMP_ASSEMBLY"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NUMBA_DUMP_ASSEMBLY</span></code></a> environment variable to 1:</p>
<div class="highlight-gas notranslate"><div class="highlight"><pre><span></span>        <span class="na">.globl</span>  <span class="no">__main__.add$1.int64.int64</span>
        <span class="na">.align</span>  <span class="mi">16</span><span class="p">,</span> <span class="mi">0x90</span>
        <span class="na">.type</span>   <span class="no">__main__.add$1.int64.int64</span><span class="p">,</span><span class="na">@function</span>
<span class="nl">__main__.add$1.int64.int64:</span>
        <span class="nf">addq</span>    <span class="nv">%r8</span><span class="p">,</span> <span class="nv">%rcx</span>
        <span class="nf">movq</span>    <span class="nv">%rcx</span><span class="p">,</span> <span class="p">(</span><span class="nv">%rdi</span><span class="p">)</span>
        <span class="nf">xorl</span>    <span class="nv">%eax</span><span class="p">,</span> <span class="nv">%eax</span>
        <span class="nf">retq</span>
</pre></div>
</div>
<p>The assembly output will also include the generated wrapper function that
translates the Python arguments to native data types.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dispatching.html" class="btn btn-neutral float-right" title="Polymorphic dispatching" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="repomap.html" class="btn btn-neutral float-left" title="A Map of the Numba Repository" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2012-2020, Anaconda, Inc. and others

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>