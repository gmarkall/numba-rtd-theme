

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.15. CUDA Array Interface (Version 2) &mdash; Numba 0.49.0dev0+639.ga41f4317f.dirty documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/numba-blue-icon-rgb.svg"/>
  
  
  
    <link rel="canonical" href="http://numba.pydata.org/numba-doc/latest/index.htmlcuda/cuda_array_interface.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/rtd-overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.16. CUDA Frequently Asked Questions" href="faq.html" />
    <link rel="prev" title="3.14. Sharing CUDA Memory" href="ipc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #00A3E0" >
          

          
            <a href="../index.html" class="icon icon-home"> Numba
          

          
            
            <img src="../_static/numba-white-icon-rgb.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.49
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">1. User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">2. Reference Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">3. Numba for CUDA GPUs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">3.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernels.html">3.2. Writing CUDA Kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">3.3. Memory management</a></li>
<li class="toctree-l2"><a class="reference internal" href="device-functions.html">3.4. Writing Device Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cudapysupported.html">3.5. Supported Python features in CUDA Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="intrinsics.html">3.6. Supported Atomic Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">3.7. Random Number Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="device-management.html">3.8. Device management</a></li>
<li class="toctree-l2"><a class="reference internal" href="device-management.html#the-device-list">3.9. The Device List</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">3.10. Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulator.html">3.11. Debugging CUDA Python with the the CUDA Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="reduction.html">3.12. GPU Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="ufunc.html">3.13. CUDA Ufuncs and Generalized Ufuncs</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipc.html">3.14. Sharing CUDA Memory</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.15. CUDA Array Interface (Version 2)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#python-interface-specification">3.15.1. Python Interface Specification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#differences-with-cuda-array-interface-version-0">3.15.1.1. Differences with CUDA Array Interface (Version 0)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#differences-with-cuda-array-interface-version-1">3.15.1.2. Differences with CUDA Array Interface (Version 1)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interoperability">3.15.1.3. Interoperability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="faq.html">3.16. CUDA Frequently Asked Questions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cuda-reference/index.html">4. CUDA Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roc/index.html">5. Numba for AMD ROC GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">6. Extending Numba</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">7. Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proposals/index.html">8. Numba Enhancement Proposals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">9. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">10. Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Numba</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">3. Numba for CUDA GPUs</a> &raquo;</li>
        
      <li>3.15. CUDA Array Interface (Version 2)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/cuda/cuda_array_interface.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cuda-array-interface-version-2">
<span id="cuda-array-interface"></span><h1>3.15. CUDA Array Interface (Version 2)<a class="headerlink" href="#cuda-array-interface-version-2" title="Permalink to this headline">¶</a></h1>
<p>The <em>cuda array interface</em> is created for interoperability between different
implementation of GPU array-like objects in various projects.  The idea is
borrowed from the <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/arrays.interface.html#__array_interface__">numpy array interface</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, we only define the Python-side interface.  In the future, we may
add a C-side interface for efficient exchange of the information in
compiled code.</p>
</div>
<div class="section" id="python-interface-specification">
<h2>3.15.1. Python Interface Specification<a class="headerlink" href="#python-interface-specification" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Experimental feature.  Specification may change.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">__cuda_array_interface__</span></code> attribute returns a dictionary (<code class="docutils literal notranslate"><span class="pre">dict</span></code>)
that must contain the following entries:</p>
<ul>
<li><p><strong>shape</strong>: <code class="docutils literal notranslate"><span class="pre">(integer,</span> <span class="pre">...)</span></code></p>
<p>A tuple of <code class="docutils literal notranslate"><span class="pre">int</span></code> (or <code class="docutils literal notranslate"><span class="pre">long</span></code>) representing the size of each dimension.</p>
</li>
<li><p><strong>typestr</strong>: <code class="docutils literal notranslate"><span class="pre">str</span></code></p>
<p>The type string.  This has the same definition as <code class="docutils literal notranslate"><span class="pre">typestr</span></code> in the
<a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/arrays.interface.html#__array_interface__">numpy array interface</a>.</p>
</li>
<li><p><strong>data</strong>: <code class="docutils literal notranslate"><span class="pre">(integer,</span> <span class="pre">boolean)</span></code></p>
<p>The <strong>data</strong> is a 2-tuple.  The first element is the data pointer
as a Python <code class="docutils literal notranslate"><span class="pre">int</span></code> (or <code class="docutils literal notranslate"><span class="pre">long</span></code>).  The data must be device-accessible.
For zero-size arrays, use <code class="docutils literal notranslate"><span class="pre">0</span></code> here.
The second element is the read-only flag as a Python <code class="docutils literal notranslate"><span class="pre">bool</span></code>.</p>
<p>Because the user of the interface may or may not be in the same context,
the most common case is to use <code class="docutils literal notranslate"><span class="pre">cuPointerGetAttribute</span></code> with
<code class="docutils literal notranslate"><span class="pre">CU_POINTER_ATTRIBUTE_DEVICE_POINTER</span></code> in the CUDA driver API (or the
equivalent CUDA Runtime API) to retrieve a device pointer that
is usable in the currently active context.</p>
</li>
<li><p><strong>version</strong>: <code class="docutils literal notranslate"><span class="pre">integer</span></code></p>
<p>An integer for the version of the interface being exported.
The current version is <em>2</em>.</p>
</li>
</ul>
<p>The following are optional entries:</p>
<ul>
<li><p><strong>strides</strong>: <code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">(integer,</span> <span class="pre">...)</span></code></p>
<p>If <strong>strides</strong> is not given, or it is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the array is in
C-contiguous layout. Otherwise, a tuple of <code class="docutils literal notranslate"><span class="pre">int</span></code> (or <code class="docutils literal notranslate"><span class="pre">long</span></code>) is explicitly
given for representing the number of bytes to skip to access the next
element at each dimension.</p>
</li>
<li><p><strong>descr</strong></p>
<p>This is for describing more complicated types.  This follows the same
specification as in the <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/arrays.interface.html#__array_interface__">numpy array interface</a>.</p>
</li>
<li><p><strong>mask</strong>: <code class="docutils literal notranslate"><span class="pre">None</span></code> or object exposing the <code class="docutils literal notranslate"><span class="pre">__cuda_array_interface__</span></code></p>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all values in <strong>data</strong> are valid. All elements of the mask
array should be interpreted only as true or not true indicating which
elements of this array are valid. This has the same definition as <code class="docutils literal notranslate"><span class="pre">mask</span></code>
in the <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/arrays.interface.html#__array_interface__">numpy array interface</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Numba does not currently support working with masked CUDA arrays
and will raise a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code> exception if one is passed
to a GPU function.</p>
</div>
</li>
</ul>
<p>Additional information about the data pointer can be retrieved using
<code class="docutils literal notranslate"><span class="pre">cuPointerGetAttribute</span></code> or <code class="docutils literal notranslate"><span class="pre">cudaPointerGetAttributes</span></code>.  Such information
include:</p>
<ul class="simple">
<li><p>the CUDA context that owns the pointer;</p></li>
<li><p>is the pointer host-accessible?</p></li>
<li><p>is the pointer a managed memory?</p></li>
</ul>
<div class="section" id="differences-with-cuda-array-interface-version-0">
<h3>3.15.1.1. Differences with CUDA Array Interface (Version 0)<a class="headerlink" href="#differences-with-cuda-array-interface-version-0" title="Permalink to this headline">¶</a></h3>
<p>Version 0 of the CUDA Array Interface did not have the optional <strong>mask</strong>
attribute to support masked arrays.</p>
</div>
<div class="section" id="differences-with-cuda-array-interface-version-1">
<h3>3.15.1.2. Differences with CUDA Array Interface (Version 1)<a class="headerlink" href="#differences-with-cuda-array-interface-version-1" title="Permalink to this headline">¶</a></h3>
<p>Versions 0 and 1 of the CUDA Array Interface neither clarified the
<strong>strides</strong> attribute for C-contiguous arrays nor specified the treatment for
zero-size arrays.</p>
</div>
<div class="section" id="interoperability">
<h3>3.15.1.3. Interoperability<a class="headerlink" href="#interoperability" title="Permalink to this headline">¶</a></h3>
<p>The following Python libraries have adopted the CUDA Array Interface:</p>
<ul>
<li><p>Numba</p></li>
<li><p><a class="reference external" href="https://docs-cupy.chainer.org/en/stable/reference/interoperability.html">CuPy</a></p></li>
<li><p><a class="reference external" href="https://pytorch.org">PyTorch</a></p></li>
<li><p><a class="reference external" href="https://arrow.apache.org/docs/python/generated/pyarrow.cuda.Context.html#pyarrow.cuda.Context.buffer_from_object">PyArrow</a></p></li>
<li><p><a class="reference external" href="https://mpi4py.readthedocs.io/en/latest/overview.html#support-for-cuda-aware-mpi">mpi4py</a></p></li>
<li><p><a class="reference external" href="https://github.com/xnd-project/arrayviews">ArrayViews</a></p></li>
<li><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/index.html">JAX</a></p></li>
<li><p>The RAPIDS stack:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://rapidsai.github.io/projects/cudf/en/0.11.0/10min-cudf-cupy.html">cuDF</a></p></li>
<li><p><a class="reference external" href="https://docs.rapids.ai/api/cuml/nightly/">cuML</a></p></li>
<li><p><a class="reference external" href="https://github.com/rapidsai/cusignal">cuSignal</a></p></li>
<li><p><a class="reference external" href="https://docs.rapids.ai/api/rmm/stable/">RMM</a></p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>If your project is not on this list, please feel free to report it on the <a class="reference external" href="https://github.com/numba/numba/issues">Numba issue tracker</a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="faq.html" class="btn btn-neutral float-right" title="3.16. CUDA Frequently Asked Questions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ipc.html" class="btn btn-neutral float-left" title="3.14. Sharing CUDA Memory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2020, Anaconda, Inc. and others

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>