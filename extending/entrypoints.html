

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.5. Registering Extensions with Entry Points &mdash; Numba 0.49.0dev0+636.ga4807f5d8 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/numba-blue-icon-rgb.svg"/>
  
  
  
    <link rel="canonical" href="http://numba.pydata.org/numba-doc/latest/index.htmlextending/entrypoints.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Developer Manual" href="../developer/index.html" />
    <link rel="prev" title="6.4. A guide to using @overload" href="overloading-guide.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Numba
          

          
            
            <img src="../_static/numba-blue-icon-rgb.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.49
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">1. User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">2. Reference Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cuda/index.html">3. Numba for CUDA GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cuda-reference/index.html">4. CUDA Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roc/index.html">5. Numba for AMD ROC GPUs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">6. Extending Numba</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="high-level.html">6.1. High-level extension API</a></li>
<li class="toctree-l2"><a class="reference internal" href="low-level.html">6.2. Low-level extension API</a></li>
<li class="toctree-l2"><a class="reference internal" href="interval-example.html">6.3. Example: an interval type</a></li>
<li class="toctree-l2"><a class="reference internal" href="overloading-guide.html">6.4. A guide to using <code class="docutils literal notranslate"><span class="pre">&#64;overload</span></code></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.5. Registering Extensions with Entry Points</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-support-for-the-init-entry-point">6.5.1. Adding Support for the “Init” Entry Point</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-your-entry-point">6.5.2. Testing your Entry Point</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">7. Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proposals/index.html">8. Numba Enhancement Proposals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">9. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">10. Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Numba</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">6. Extending Numba</a> &raquo;</li>
        
      <li>6.5. Registering Extensions with Entry Points</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/extending/entrypoints.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="registering-extensions-with-entry-points">
<h1>6.5. Registering Extensions with Entry Points<a class="headerlink" href="#registering-extensions-with-entry-points" title="Permalink to this headline">¶</a></h1>
<p>Often, third party packages will have a user-facing API as well as define
extensions to the Numba compiler.  In those situations, the new types and
overloads can registered with Numba when the package is imported by the user.
However, there are situations where a Numba extension would not normally be
imported directly by the user, but must still be registered with the Numba
compiler.  An example of this is the <a class="reference external" href="https://github.com/numba/numba-scipy">numba-scipy</a> package, which adds support for some
SciPy functions to Numba.  The end user does not need to <code class="docutils literal notranslate"><span class="pre">import</span>
<span class="pre">numba_scipy</span></code> to enable compiler support for SciPy, the extension only needs
to be installed in the Python environment.</p>
<p>Numba discovers extensions using the <a class="reference external" href="https://setuptools.readthedocs.io/en/latest/setuptools.html#dynamic-discovery-of-services-and-plugins">entry points</a>
feature of <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>.  This allows a Python package to register an
initializer function that will be called before <code class="docutils literal notranslate"><span class="pre">numba</span></code> compiles for the
first time.  The delay ensures that the cost of importing extensions is
deferred until it is necessary.</p>
<div class="section" id="adding-support-for-the-init-entry-point">
<h2>6.5.1. Adding Support for the “Init” Entry Point<a class="headerlink" href="#adding-support-for-the-init-entry-point" title="Permalink to this headline">¶</a></h2>
<p>A package can register an initialization function with Numba by adding the
<code class="docutils literal notranslate"><span class="pre">entry_points</span></code> argument to the <code class="docutils literal notranslate"><span class="pre">setup()</span></code> function call in <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">setup</span><span class="p">(</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;numba_extensions&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;init = numba_scipy:_init_extension&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">},</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Numba currently only looks for the <code class="docutils literal notranslate"><span class="pre">init</span></code> entry point in the
<code class="docutils literal notranslate"><span class="pre">numba_extensions</span></code> group.  The entry point should be a function (any name,
as long as it matches what is listed in <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>) that takes no arguments,
and the return value is ignored.  This function should register types,
overloads, or call other Numba extension APIs.  The order of initialization of
extensions is undefined.</p>
</div>
<div class="section" id="testing-your-entry-point">
<h2>6.5.2. Testing your Entry Point<a class="headerlink" href="#testing-your-entry-point" title="Permalink to this headline">¶</a></h2>
<p>Numba loads all entry points when the first function is compiled. To test your
entry point, it is not sufficient to just <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numba</span></code>; you have to define
and run a small function, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numba</span><span class="p">;</span> <span class="n">numba</span><span class="o">.</span><span class="n">njit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)(</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
<p>It is not necessary to import your module: entry points are identified by the
<code class="docutils literal notranslate"><span class="pre">entry_points.txt</span></code> file in your library’s <code class="docutils literal notranslate"><span class="pre">*.egg-info</span></code> directory.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">setup.py</span> <span class="pre">build</span></code> command does not create eggs, but <code class="docutils literal notranslate"><span class="pre">setup.py</span> <span class="pre">sdist</span></code>
(for testing in a local directory) and <code class="docutils literal notranslate"><span class="pre">setup.py</span> <span class="pre">install</span></code> do. All entry points
registered in eggs that are on the Python path are loaded. Be sure to check for
stale <code class="docutils literal notranslate"><span class="pre">entry_points.txt</span></code> when debugging.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../developer/index.html" class="btn btn-neutral float-right" title="7. Developer Manual" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="overloading-guide.html" class="btn btn-neutral float-left" title="6.4. A guide to using @overload" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2020, Anaconda, Inc. and others

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>